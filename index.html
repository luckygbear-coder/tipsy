<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>æ‰¾å¾®é†ºç†Šè¬›å¿ƒäº‹</title>

  <!-- PWA -->
  <link rel="manifest" href="manifest.webmanifest">
  <meta name="theme-color" content="#ffeec9" />
  <link rel="icon" sizes="192x192" href="icons/tipsy-bear-192.png">
  <link rel="apple-touch-icon" href="icons/tipsy-bear-512.png">

  <style>
    :root{
      --bg:#ffeec9;
      --card:#fff7e6;
      --border:#e1b676;
      --shadow:rgba(0,0,0,.14);
      --text:#4b3044;
      --muted:#7a5a6a;
      --btn:#ffcc6a;
      --btn2:#ffdca0;
      --pink1:#ffd1f0;
      --pink2:#ffe6fa;
      --mask:rgba(0,0,0,.35);
      --dockH: 156px; /* âœ… é ç•™åº•æ¬„é«˜åº¦ï¼Œé¿å…è£åˆ‡ */
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      background:var(--bg);
      font-family:"Noto Sans TC",-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
      color:var(--text);
      overflow:hidden; /* âœ… ä¸»é«”ä¸æ²å‹•ï¼Œäº¤çµ¦ main / modal æ² */
    }

    /* âœ… iOS æ­£ç¢ºæ»¿ç‰ˆï¼šç”¨ dvh + é ç•™åº•æ¬„ç©ºé–“ */
    .app{
      min-height: 100dvh;
      display:flex;
      flex-direction:column;
      padding-bottom: calc(var(--dockH) + env(safe-area-inset-bottom));
    }

    .header{padding:14px 14px 10px;}
    .topbar{
      display:flex; gap:12px; align-items:center;
      padding:14px; border:2px solid var(--border);
      background:linear-gradient(180deg,#fff3d8,#fff7e6);
      border-radius:18px; box-shadow:0 8px 20px var(--shadow);
    }
    .logo{
      width:62px;height:62px;border-radius:16px;
      border:2px solid var(--border);
      background:#fff; overflow:hidden; flex:0 0 auto;
      display:flex; align-items:center; justify-content:center;
    }
    .logo img{width:100%;height:100%;object-fit:cover}
    .title{flex:1;min-width:0}
    .title h1{margin:0;font-size:18px;letter-spacing:.4px}
    .title p{margin:6px 0 0; color:var(--muted); font-size:13px; line-height:1.35}

    /* âœ… ä¸»å…§å®¹å¯ä»¥æ²å‹•ã€ä¸è¢«åº•æ¬„å£“ä½ */
    .main{
      flex:1;
      min-height:0;
      overflow:auto;
      -webkit-overflow-scrolling: touch;
      padding:0 14px 10px;
      display:flex;
      flex-direction:column;
      gap:12px;
    }

    .hero{
      border-radius:20px;
      overflow:hidden;
      border:2px solid var(--border);
      box-shadow:0 10px 24px var(--shadow);
      background:#fff;
      position:relative;
      flex:1;
      min-height:220px;
    }
    .hero img{width:100%;height:100%;object-fit:cover;display:block}
    .badge{
      position:absolute; left:10px; top:10px;
      background:rgba(255,247,230,.92);
      border:2px solid var(--border);
      padding:8px 10px; border-radius:999px;
      font-size:12px;
      box-shadow:0 6px 14px rgba(0,0,0,.10);
    }

    .row2{display:grid;grid-template-columns:1fr 1fr;gap:10px;}

    .btn{
      appearance:none; border:none; cursor:pointer;
      background:linear-gradient(180deg,var(--btn),var(--btn2));
      border:2px solid var(--border);
      border-radius:16px;
      padding:12px 10px;
      font-size:14px;
      color:var(--text);
      box-shadow:0 6px 14px rgba(0,0,0,.10);
      display:flex; align-items:center; justify-content:center;
      gap:8px;
      user-select:none;
      transition:transform .08s ease, filter .15s ease;
    }
    .btn:active{transform:translateY(1px) scale(.99)}
    .btn.secondary{background:#fff;}
    .btn.ig{background:linear-gradient(180deg,var(--pink1),var(--pink2));}
    .btn.small{padding:10px 10px; font-size:13px; border-radius:14px;}
    .btn.ghost{background:#fff; border-style:dashed;}

    .moods{display:flex; flex-wrap:wrap; gap:8px; align-items:center;}
    .mood-btn{
      border:none; cursor:pointer;
      background:#fff;
      border:2px solid var(--border);
      border-radius:999px;
      padding:8px 10px;
      font-size:13px;
      box-shadow:0 4px 10px rgba(0,0,0,.08);
      color:var(--text);
      user-select:none;
    }
    .mood-btn.active{background:linear-gradient(180deg,#fff0c8,#fff7e6);}
    .mood-pill{
      font-size:12px;color:var(--muted);
      background:#fff; border:1px dashed var(--border);
      padding:6px 10px;border-radius:999px;
      white-space:nowrap;
      align-self:flex-start;
    }

    /* âœ… åº•æ¬„å›ºå®šï¼Œä¸è£åˆ‡ */
    .dock{
      position:fixed;
      left:0; right:0; bottom:0;
      z-index:70;

      padding:10px 14px calc(10px + env(safe-area-inset-bottom));
      background:rgba(255,247,230,.95);
      border-top:2px solid var(--border);
      box-shadow:0 -10px 24px rgba(0,0,0,.08);
    }
    .dock-inner{
      max-width:480px;margin:0 auto;
      display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px;
    }

    /* Toast */
    .toast{
      position:fixed; left:50%; bottom:calc(var(--dockH) + 14px);
      transform:translateX(-50%);
      background:rgba(75,48,68,.92);
      color:#fff;
      padding:10px 12px;
      border-radius:999px;
      font-size:13px;
      opacity:0; pointer-events:none;
      transition:opacity .18s ease;
      max-width:92vw;
      text-align:center;
      z-index:90;
    }
    .toast.show{opacity:1}

    /* Modal */
    .modal-mask{
      position:fixed; inset:0;
      background:var(--mask);
      display:none;
      align-items:flex-end;
      z-index:80;
    }
    .modal-mask.show{display:flex;}
    .modal{
      width:100%;
      max-width:480px;
      margin:0 auto;
      background:#fff;
      border:2px solid var(--border);
      border-bottom:none;
      border-radius:18px 18px 0 0;
      box-shadow:0 -12px 30px rgba(0,0,0,.22);
      padding:14px;

      max-height: 88dvh; /* âœ… iOS ä¸å¿½å¤§å¿½å° */
      overflow:hidden;
    }
    .modal-head{
      display:flex; align-items:center; justify-content:space-between; gap:10px;
      margin-bottom:10px;
    }
    .modal-head h3{margin:0;font-size:16px}
    .xbtn{
      border:none; cursor:pointer;
      background:#fff;
      border:2px solid var(--border);
      border-radius:12px;
      padding:8px 10px;
      font-size:13px;
      box-shadow:0 4px 10px rgba(0,0,0,.08);
      user-select:none;
    }

    /* ç†Šç†Šå°è©±ï¼ˆå¯é»æ›å¥ï¼‰ */
    .chat-row{display:flex; gap:10px; align-items:flex-start; margin-top:6px;}
    .avatar{
      width:42px;height:42px;border-radius:14px;
      border:2px solid var(--border);
      overflow:hidden;background:#fff;flex:0 0 auto;
    }
    .avatar img{width:100%;height:100%;object-fit:cover}
    .bubble{
      flex:1;
      background:#fff;
      border:2px solid var(--border);
      border-radius:16px;
      padding:10px 12px;
      box-shadow:0 6px 14px rgba(0,0,0,.10);
      position:relative;
      font-size:13px; line-height:1.55;
      white-space:pre-wrap;
      cursor:pointer;
    }
    .bubble:before{
      content:"";
      position:absolute; left:-8px; top:12px;
      width:14px;height:14px;
      background:#fff;
      border-left:2px solid var(--border);
      border-bottom:2px solid var(--border);
      transform:rotate(45deg);
    }
    .bubble-tip{
      margin-top:6px;
      font-size:12px;
      color:var(--muted);
      text-align:right;
      user-select:none;
    }

    /* é…’å¡ */
    .drink-head{display:flex; gap:10px; align-items:flex-start; margin-top:10px;}
    .emoji{
      width:44px;height:44px;border-radius:14px;
      border:2px solid var(--border);
      background:#fff7e6;
      display:flex;align-items:center;justify-content:center;
      font-size:24px;flex:0 0 auto;
    }
    .drink-meta{flex:1}
    .drink-meta h4{margin:0;font-size:16px}
    .tag{margin:6px 0 0;color:var(--muted);font-size:12px;line-height:1.4}
    .pillline{
      margin-top:6px;
      font-size:12px;color:var(--muted);
      background:#fff;border:1px dashed var(--border);
      padding:6px 10px;border-radius:999px;
      display:inline-block;
    }

    .content{
      overflow:auto;
      max-height:58dvh;
      padding-right:4px;
      margin-top:10px;
      -webkit-overflow-scrolling: touch;
    }
    .block{margin-top:10px}
    .label{font-size:12px;color:var(--muted);margin-bottom:4px}
    .text{
      background:#fff7e6;
      border:1px solid rgba(225,182,118,.65);
      border-radius:12px;
      padding:10px;
      line-height:1.55;
      font-size:13px;
      white-space:pre-wrap;
    }
    .warn{background:#fff1f1;border:1px solid rgba(176,71,71,.35);color:#6a2b2b;}

    /* tabs + åˆ†é¡ */
    .tabs{display:flex; gap:8px; margin:10px 0;}
    .tab{
      flex:1;
      border:none; cursor:pointer;
      background:#fff;
      border:2px solid var(--border);
      border-radius:999px;
      padding:9px 10px;
      font-size:13px;
      box-shadow:0 4px 10px rgba(0,0,0,.08);
      user-select:none;
    }
    .tab.active{background:linear-gradient(180deg,#fff0c8,#fff7e6);}

    .filters{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      margin:6px 0 10px;
    }
    .filter-btn{
      border:none; cursor:pointer;
      background:#fff;
      border:2px solid rgba(225,182,118,.7);
      border-radius:999px;
      padding:7px 10px;
      font-size:12px;
      box-shadow:0 3px 8px rgba(0,0,0,.07);
      user-select:none;
    }
    .filter-btn.active{background:linear-gradient(180deg,#fff0c8,#fff7e6);}

    .search{display:flex; gap:8px; align-items:center; margin:6px 0 10px;}
    .search input{
      flex:1;
      border:2px solid rgba(225,182,118,.7);
      border-radius:14px;
      padding:10px 12px;
      font-size:16px; /* âœ… é˜²æ­¢ iOS é»è¼¸å…¥æ¡†è‡ªå‹•æ”¾å¤§ */
      outline:none;
      background:#fff;
    }

    .item{
      border:2px solid rgba(225,182,118,.55);
      border-radius:14px;
      padding:10px;
      margin-bottom:10px;
      background:#fff7e6;
    }
    .item-top{display:flex; gap:10px; align-items:flex-start;}
    .item-emoji{
      width:38px;height:38px;border-radius:12px;
      border:2px solid var(--border);
      background:#fff;
      display:flex;align-items:center;justify-content:center;
      font-size:20px; flex:0 0 auto;
    }
    .item h5{margin:0;font-size:14px}
    .item .meta{margin-top:4px;font-size:12px;color:var(--muted);line-height:1.35}
    .item-actions{display:flex; gap:8px; margin-top:10px; flex-wrap:wrap;}
    .smallnote{
      margin-top:10px;
      color:var(--muted);
      font-size:12px;
      line-height:1.5;
      text-align:center;
    }

    /* ç­‰å¾…å‹•ç•« */
    .loading{
      position:fixed; inset:0;
      background:rgba(255,238,201,.85);
      display:none;
      align-items:center;
      justify-content:center;
      z-index:95;
      backdrop-filter: blur(2px);
    }
    .loading.show{display:flex;}
    .load-card{
      width:min(360px, 92vw);
      background:#fff;
      border:2px solid var(--border);
      border-radius:18px;
      box-shadow:0 12px 30px rgba(0,0,0,.18);
      padding:14px;
      text-align:center;
    }
    .load-bear{
      width:84px;height:84px;border-radius:24px;
      border:2px solid var(--border);
      overflow:hidden;
      margin:0 auto 10px;
      background:#fff;
      animation:bob 1.1s ease-in-out infinite;
    }
    .load-bear img{width:100%;height:100%;object-fit:cover}
    @keyframes bob{0%,100%{transform:translateY(0)}50%{transform:translateY(-6px)}}
    .dots{display:flex; gap:6px; justify-content:center; margin-top:10px;}
    .dot{width:8px;height:8px;border-radius:999px;background:rgba(75,48,68,.7);animation:blink 1s infinite ease-in-out;}
    .dot:nth-child(2){animation-delay:.15s}
    .dot:nth-child(3){animation-delay:.3s}
    @keyframes blink{0%,100%{transform:translateY(0);opacity:.35}50%{transform:translateY(-6px);opacity:1}}

    /* è¨˜ä½å¿ƒæƒ… input */
    .memo-wrap{
      display:flex;
      gap:8px;
      align-items:center;
      margin-top:10px;
    }
    .memo-wrap input{
      flex:1;
      border:2px solid rgba(225,182,118,.7);
      border-radius:14px;
      padding:10px 12px;
      font-size:16px; /* âœ… é˜²æ­¢ iOS æ”¾å¤§ */
      outline:none;
      background:#fff;
    }
    /* ===== ä¸»ç•«é¢é»ç†Šç†Šï¼šç´”èŠå¤©è·³çª—ï¼ˆä¸å½±éŸ¿é…’åŠŸèƒ½ï¼‰ ===== */
.hero{ cursor:pointer; user-select:none; }

.tapHint{
  position:absolute; right:10px; top:10px;
  background:rgba(255,247,230,.92);
  border:2px dashed var(--border);
  padding:8px 10px; border-radius:999px;
  font-size:12px;
  box-shadow:0 6px 14px rgba(0,0,0,.08);
}

.chatOnly-note{
  margin-top:10px;
  color:var(--muted);
  font-size:12px;
  line-height:1.5;
  text-align:center;
}
  </style>
</head>

<body>
  <div class="app">
    <div class="header">
      <div class="topbar">
        <div class="logo"><img id="bearIconTop" alt="å¾®é†ºç†Š"></div>
        <div class="title">
          <h1>æ‰¾å¾®é†ºç†Šè¬›å¿ƒäº‹ ğŸ»ğŸ·</h1>
          <p id="todayLine">ã€Œä»Šå¤©çš„ä½ è¾›è‹¦äº†ï¼Œä¾†ä¸€å£æº«æŸ”ã€‚ã€</p>
        </div>
      </div>
    </div>

    <div class="main">
      <div class="hero">
        <img id="bearHeroImg" alt="å¾®é†ºç†Šä¸»åœ–">
        <div class="badge" id="countBadge">ğŸ‡ å¾®é†ºé…’çª–ï½œå·²æ”¶éŒ„ 33 æ¯</div>
      </div>

      <div class="row2">
        <button class="btn" id="btnRandom">ğŸ² éš¨æ©Ÿä¸€æ¯</button>
        <button class="btn secondary" id="btnPickList">ğŸ“š é…’æ¸…å–®ï¼ˆè‡ªå·±é¸ï¼‰</button>
      </div>

      <div class="row2">
        <button class="btn secondary" id="btnTalk">ğŸ’¬ å…ˆè·Ÿç†Šç†Šèªªèªª</button>
        <button class="btn secondary" id="btnWarn">âš ï¸ å¾®é†ºæé†’</button>
      </div>

      <div style="display:flex;gap:10px;align-items:flex-start;justify-content:space-between;">
        <div class="moods" id="moodRow">
          <button class="mood-btn" data-mood="é–‹å¿ƒ">ğŸ˜„ é–‹å¿ƒ</button>
          <button class="mood-btn" data-mood="ç–²æ†Š">ğŸ˜®â€ğŸ’¨ ç–²æ†Š</button>
          <button class="mood-btn" data-mood="æƒ³èŠå¤©">ğŸ—£ï¸ æƒ³èŠå¤©</button>
          <button class="mood-btn" data-mood="æƒ³æ”¾ä¸‹">ğŸ‚ æƒ³æ”¾ä¸‹</button>
          <button class="mood-btn" data-mood="æƒ³æ…¶ç¥">ğŸ‰ æƒ³æ…¶ç¥</button>
          <button class="mood-btn" data-mood="æ¸…é†’ä¹Ÿå¥½">ğŸš— æ¸…é†’ä¹Ÿå¥½</button>
        </div>
        <div class="mood-pill" id="moodPill">æœªé¸æ“‡</div>
      </div>
    </div>

    <div class="dock">
      <div class="dock-inner">
        <button class="btn small secondary" id="btnHistory">ğŸ•°ï¸ ç´€éŒ„</button>
        <button class="btn small secondary" id="btnFavList">â­ æ”¶è—</button>
        <button class="btn small ig" id="btnIG">ğŸ“· æ‰¾å¾®é†ºç†Šèªªå¿ƒäº‹</button>
      </div>
      <div class="dock-inner" style="grid-template-columns:1fr;">
        <button class="btn small" id="btnInstall" style="display:none;">ğŸ“² åŠ åˆ°ä¸»ç•«é¢</button>
      </div>
    </div>
  </div>

  <!-- Loading -->
  <div class="loading" id="loading">
    <div class="load-card">
      <div class="load-bear"><img id="loadBear" alt="å¾®é†ºç†Š"></div>
      <div style="font-size:14px;line-height:1.5;">
        ğŸ»ã€Œæˆ‘åœ¨é…’çª–å¹«ä½ æŒ‘ä¸€æ¯â€¦ã€<br>
        <span style="color:var(--muted);font-size:12px;">ï¼ˆå°æé†’ï¼šæ…¢æ…¢å–æœ€å¹¸ç¦ï¼‰</span>
      </div>
      <div class="dots" aria-hidden="true"><div class="dot"></div><div class="dot"></div><div class="dot"></div></div>
    </div>
  </div>

  <!-- Modalï¼šé…’å¡ -->
  <div class="modal-mask" id="drinkMask">
    <div class="modal">
      <div class="modal-head">
        <h3 id="drinkTitle">ä»Šæ™šçš„ä¸€æ¯</h3>
        <button class="xbtn" id="drinkClose">é—œé–‰ âœ•</button>
      </div>

      <div class="chat-row">
        <div class="avatar"><img id="bearAvatar" alt="å¾®é†ºç†Š"></div>
        <div style="flex:1">
          <div class="bubble" id="bearBubble" title="é»æˆ‘æ›ä¸€å¥ç†Šç†Šè©± ğŸ»">ğŸ»ã€Œæˆ‘åœ¨é€™è£¡ï¼Œæ…¢æ…¢ä¾†ã€‚ã€</div>
          <div class="bubble-tip">ï¼ˆé»ä¸€ä¸‹ç†Šç†Šè©±èªï¼Œå¯ä»¥æ›ä¸€å¥ï¼‰</div>
        </div>
      </div>

      <div class="drink-head">
        <div class="emoji" id="drinkEmoji">ğŸ·</div>
        <div class="drink-meta">
          <h4 id="drinkName">â€”</h4>
          <div class="tag" id="drinkTag">â€”</div>
          <div class="pillline" id="drinkMoodLine" style="display:none;"></div>
        </div>
      </div>

      <div class="content">
        <div class="block">
          <div class="label">ğŸ§¸ ç†Šç†Šå»¶ä¼¸ï¼ˆè¿½å•ä¸€å¥ï¼‰</div>
          <div class="text" id="drinkFollow">â€”</div>
        </div>
        <div class="block">
          <div class="label">ğŸ“– é…’çš„æ•…äº‹</div>
          <div class="text" id="drinkStory">â€”</div>
        </div>
        <div class="block">
          <div class="label">ğŸ‘ƒ ç‰¹æ®Šé¢¨å‘³ãƒ»æ°£å‘³</div>
          <div class="text" id="drinkFlavor">â€”</div>
        </div>
        <div class="block">
          <div class="label">âœ¨ ç‰¹æ€§</div>
          <div class="text" id="drinkTrait">â€”</div>
        </div>
        <div class="block">
          <div class="label">âš ï¸ æé†’</div>
          <div class="text warn" id="drinkWarn">â€”</div>
        </div>

        <!-- âœ… ä»Šæ™šæˆ‘æƒ³è¨˜ä½ -->
        <div class="block">
          <div class="label">ğŸ“ ä»Šæ™šæˆ‘æƒ³è¨˜ä½</div>
          <div class="memo-wrap">
            <input id="memoInput" placeholder="è¼¸å…¥ä¸€å¥ä½ æƒ³è¨˜ä½çš„å¿ƒæƒ…ï¼ˆä¾‹å¦‚ï¼šæˆ‘å…¶å¯¦å¾ˆåŠªåŠ›äº†ï¼‰" maxlength="60" />
            <button class="btn small" id="btnSaveMemo">ä¿å­˜</button>
          </div>
        </div>
      </div>

      <div class="row2" style="margin-top:10px;">
        <button class="btn small" id="btnFav">â­ æ”¶è—</button>
        <button class="btn small secondary" id="btnCopy">ğŸ“‹ è¤‡è£½ç†Šç†Šè©±èª</button>
      </div>

      <div class="smallnote">æœªæ»¿ 18 è«‹å‹¿é£²é…’ï½œå–é…’ä¸é–‹è»Šï½œå°å£æ…¢æ…¢å–</div>
    </div>
  </div>

  <!-- Modalï¼šæ¸…å–®/æ­·å²/æ”¶è— -->
  <div class="modal-mask" id="listMask">
    <div class="modal">
      <div class="modal-head">
        <h3 id="listTitle">ğŸ“š é…’æ¸…å–®</h3>
        <button class="xbtn" id="listClose">é—œé–‰ âœ•</button>
      </div>

      <div class="tabs">
        <button class="tab active" id="tabCatalog">ğŸ“š é…’æ¸…å–®</button>
        <button class="tab" id="tabHistory">ğŸ•°ï¸ æ­·å²</button>
        <button class="tab" id="tabFav">â­ æ”¶è—</button>
      </div>

      <!-- âœ… åˆ†é¡ç¯©é¸ -->
      <div class="filters" id="filterRow">
        <button class="filter-btn active" data-cat="all">å…¨éƒ¨</button>
        <button class="filter-btn" data-cat="beer">å•¤é…’</button>
        <button class="filter-btn" data-cat="red">ç´…é…’</button>
        <button class="filter-btn" data-cat="white">ç™½é…’</button>
        <button class="filter-btn" data-cat="spirit">çƒˆé…’</button>
        <button class="filter-btn" data-cat="cocktail">èª¿é…’</button>
        <button class="filter-btn" data-cat="na">ç„¡é…’ç²¾</button>
      </div>

      <div class="search" id="searchRow">
        <input id="searchInput" placeholder="æœå°‹é…’åï¼ˆä¾‹å¦‚ï¼šè«å¸Œæ‰˜ / å¨å£«å¿Œ / æ¢…é…’ï¼‰" />
        <button class="btn small secondary" id="btnSearchClear">æ¸…é™¤</button>
      </div>

      <div class="content" id="listContent" style="max-height:64dvh;"></div>

      <div class="row2" style="margin-top:10px;">
        <button class="btn small secondary" id="btnClearHistory">æ¸…ç©ºæ­·å²</button>
        <button class="btn small secondary" id="btnClearFav">æ¸…ç©ºæ”¶è—</button>
      </div>

      <div class="smallnote">é»ã€Œæ‰“é–‹ã€æœƒè·³å‡ºé‚£æ¯é…’çš„å®Œæ•´ä»‹ç´¹ã€‚</div>
    </div>
  </div>

  <div class="toast" id="toast">å·²è¤‡è£½</div>

  <script>
    // ========= åœ–ç‰‡è·¯å¾‘å®¹éŒ¯ï¼ˆImages/ æˆ– images/ éƒ½å¯ï¼‰ =========
    const IMG_TRY = ["Images/tipsy-bear.png", "images/tipsy-bear.png"];
    function setBearImages(){
      const targets = ["bearIconTop","bearHeroImg","bearAvatar","loadBear"];
      let idx = 0;
      const apply = () => targets.forEach(id => { const el = document.getElementById(id); if(el) el.src = IMG_TRY[idx]; });
      apply();
      const hero = document.getElementById("bearHeroImg");
      hero.onerror = () => { idx = Math.min(idx+1, IMG_TRY.length-1); apply(); };
    }

    // ========= åŸºæœ¬ =========
    const IG_URL = "https://instagram.com/luckygbear";
    const KEY_HISTORY = "tipsyBear_history_v5";
    const KEY_FAV = "tipsyBear_fav_v5";

    const $ = (id)=>document.getElementById(id);
    const toast = $("toast");
    const loading = $("loading");

    function showToast(msg){
      toast.textContent = msg;
      toast.classList.add("show");
      clearTimeout(showToast._t);
      showToast._t = setTimeout(()=>toast.classList.remove("show"), 1400);
    }
    function pick(arr){ return arr[Math.floor(Math.random()*arr.length)] }
    function safeJSONParse(s, fallback){ try{ return JSON.parse(s) ?? fallback; }catch(e){ return fallback; } }
    function getHistory(){ return safeJSONParse(localStorage.getItem(KEY_HISTORY), []); }
    function setHistory(list){ localStorage.setItem(KEY_HISTORY, JSON.stringify(list)); }
    function getFav(){ return safeJSONParse(localStorage.getItem(KEY_FAV), []); }
    function setFav(list){ localStorage.setItem(KEY_FAV, JSON.stringify(list)); }

    function addHistory(entry){
      const list = getHistory();
      list.unshift(entry);
      setHistory(list.slice(0, 120));
    }
    function updateHistoryMemo(ts, memo){
      const list = getHistory();
      const i = list.findIndex(x => x.ts === ts);
      if(i >= 0){
        list[i].memo = memo;
        setHistory(list);
        return true;
      }
      return false;
    }
    function toggleFav(drinkId){
      const list = getFav();
      const i = list.indexOf(drinkId);
      if(i>=0){ list.splice(i,1); setFav(list); return false; }
      list.unshift(drinkId);
      setFav(Array.from(new Set(list)).slice(0, 200));
      return true;
    }
    function isFav(drinkId){ return getFav().includes(drinkId); }

    function formatTime(ts){
      const d = new Date(ts);
      const pad = (n)=>String(n).padStart(2,"0");
      return `${d.getFullYear()}/${pad(d.getMonth()+1)}/${pad(d.getDate())} ${pad(d.getHours())}:${pad(d.getMinutes())}`;
    }

    // ========= æ–‡æ¡ˆ =========
    const TODAY_LINES = [
      "ã€Œä»Šæ™šä¸ç”¨å¾ˆå …å¼·ï¼Œå¾®é†ºå°±å¥½ã€‚ã€",
      "ã€Œä½ ä¸ç”¨è§£é‡‹ï¼Œæˆ‘é™ªä½ åä¸€ä¸‹ã€‚ã€",
      "ã€Œæ…¢æ…¢èŠï¼Œæ…¢æ…¢æŠŠä»Šå¤©æ”¾ä¸‹ã€‚ã€",
      "ã€Œä¸å–ä¹Ÿæ²’é—œä¿‚ï¼Œæˆ‘é™ªä½ èŠèŠå°±å¥½ã€‚ã€",
      "ã€Œä»Šå¤©çš„ä½ è¾›è‹¦äº†ï¼Œä¾†ä¸€å£æº«æŸ”ã€‚ã€"
    ];

    const GENERAL_WARN = [
      "âš ï¸ æœªæ»¿ 18 æ­²è«‹å‹¿é£²é…’ã€‚",
      "âš ï¸ å–é…’ä¸é–‹è»Šã€é–‹è»Šä¸å–é…’ã€‚",
      "âš ï¸ é…’é‡å› äººè€Œç•°ï¼Œå°å£æ…¢æ…¢å–ã€‚",
      "âš ï¸ å­•å©¦ã€æœè—¥ä¸­æˆ–èº«é«”ä¸é©è€…ï¼Œè«‹é¿å…é£²é…’ã€‚",
      "âš ï¸ è‹¥å¿ƒæƒ…éå¸¸ä½è½ï¼Œé…’ä¸æ˜¯è§£ç­”ï¼Œè«‹æ‰¾å¯ä¿¡ä»»çš„äººæˆ–å°ˆæ¥­å”åŠ©ã€‚"
    ];

    const MOOD_BEAR = {
      "é–‹å¿ƒ":   ["ğŸ»ã€Œå¤ªå¥½äº†ï½æˆ‘æƒ³æŠŠä½ çš„é–‹å¿ƒï¼Œè®Šæˆæ›´äº®çš„æ³¡æ³¡ã€‚ã€","ğŸ»ã€Œä»Šå¤©çš„å¥½å¿ƒæƒ…ï¼Œæˆ‘å€‘ç”¨ä¸€æ¯å‰›å‰›å¥½çš„ä¹¾æ¯æ”¶èµ·ä¾†ã€‚ã€"],
      "ç–²æ†Š":   ["ğŸ»ã€Œç´¯äº†å°±å…ˆåä¸‹ï¼Œä½ ä¸ç”¨ä¸€ç›´æ’ã€‚ã€","ğŸ»ã€Œæˆ‘å€‘æ…¢æ…¢ä¾†ï¼Œå…ˆè®“èº«é«”é¬†ä¸€é»ã€‚ã€"],
      "æƒ³èŠå¤©": ["ğŸ»ã€Œä½ èªªï¼Œæˆ‘è½ã€‚ã€","ğŸ»ã€ŒæŠŠå¿ƒäº‹å€’å‡ºä¾†ï¼Œæ¯å­å°±ä¸é‚£éº¼é‡äº†ã€‚ã€"],
      "æƒ³æ”¾ä¸‹": ["ğŸ»ã€ŒæŠŠä»Šå¤©äº¤çµ¦å¤œæ™šï¼Œå¥½å—ï¼Ÿã€","ğŸ»ã€Œæœ‰äº›äº‹ä¸ç”¨ç«‹åˆ»è§£æ±ºï¼Œå…ˆæ”¾ä¸‹ã€‚ã€"],
      "æƒ³æ…¶ç¥": ["ğŸ»ã€Œä¾†ï½æˆ‘å€‘ç‚ºä½ åŠªåŠ›åˆ°ç¾åœ¨ä¹¾æ¯ï¼ã€","ğŸ»ã€Œæ…¶ç¥ä¸ä¸€å®šè¦å¾ˆå¤§è²ï¼Œå‰›å‰›å¥½ä¹Ÿå¾ˆç¾ã€‚ã€"],
      "æ¸…é†’ä¹Ÿå¥½": ["ğŸ»ã€Œæ¸…é†’ä¹Ÿå¾ˆæ£’ï¼Œæˆ‘å€‘ç”¨å®‰å…¨çš„æ–¹å¼ç…§é¡§ä½ ã€‚ã€","ğŸ»ã€Œæˆ‘æ›´åœ¨æ„ä½ å¹³å®‰å›å®¶ã€‚ã€"]
    };

    const BEAR_EXTRA_LINES = [
      "ğŸ»ã€Œä½ é¡˜æ„èªªåˆ°å“ªè£¡éƒ½å¯ä»¥ï¼Œæˆ‘éƒ½è½ã€‚ã€",
      "ğŸ»ã€Œä½ ä¸éœ€è¦å¾ˆå¿«å¥½èµ·ä¾†ï¼Œæ…¢æ…¢ä¾†å°±å¥½ã€‚ã€",
      "ğŸ»ã€Œä½ å·²ç¶“å¾ˆåŠªåŠ›äº†ï¼ŒçœŸçš„ã€‚ã€",
      "ğŸ»ã€Œä»Šæ™šæˆ‘å€‘åªåšä¸€ä»¶äº‹ï¼šå¥½å¥½ç…§é¡§ä½ ã€‚ã€",
      "ğŸ»ã€Œå¦‚æœä½ æƒ³å“­ï¼Œä¹Ÿæ²’é—œä¿‚ã€‚ã€",
      "ğŸ»ã€Œä½ ä¸æ˜¯ä¸€å€‹äººï¼Œæˆ‘åœ¨é€™è£¡ã€‚ã€",
      "ğŸ»ã€Œæˆ‘å¯ä»¥é™ªä½ æŠŠä»Šå¤©æ”¶èµ·ä¾†ã€‚ã€"
    ];

    // ========= é…’è³‡æ–™ï¼ˆ33 æ¯ + åˆ†é¡ catï¼‰ =========
    // cat: beer / red / white / spirit / cocktail / na
    const DRINKS = [
      {id:1, cat:"beer", emoji:"ğŸº", name:"æ‹‰æ ¼ï¼ˆLagerï¼‰", tag:"æ¸…çˆ½ãƒ»é †å£ãƒ»æ—¥å¸¸å°ç¢ºå¹¸", moods:["é–‹å¿ƒ","ç–²æ†Š","æƒ³èŠå¤©"],
        story:"æ‹‰æ ¼åƒæŠŠä¸€å¤©çš„æ±—èˆ‡ç…©èºæ´—æ‰ï¼šä¹¾æ·¨ã€æ¸…çˆ½ã€å¾ˆå¯é ã€‚",
        flavor:"æ¸…çˆ½éº¥é¦™ã€æ·¡æ·¡å•¤é…’èŠ±ã€æ”¶å£ä¹¾æ·¨ã€‚",
        trait:"ç¤¾äº¤å‹å–„ã€é©åˆæ…¢æ…¢èŠã€æ˜“å…¥å£ã€‚",
        warn:"åˆ¥ç©ºè…¹ï¼›å®¹æ˜“è„¹æ°£è€…é…é»é£Ÿç‰©æ›´èˆ’æœã€‚",
        followUps:["ä½ ä»Šå¤©æœ€æƒ³æ´—æ‰çš„æ˜¯å“ªä¸€ä»¶äº‹ï¼Ÿ","ä½ æƒ³å…ˆè¢«å®‰æ…°ï¼Œé‚„æ˜¯å…ˆè¢«ç†è§£ï¼Ÿ","ä»Šå¤©ä½ æœ€ç´¯çš„åœ°æ–¹æ˜¯å“ªè£¡ï¼Ÿ"]},
      {id:2, cat:"beer", emoji:"ğŸº", name:"çš®çˆ¾æ£®ï¼ˆPilsnerï¼‰", tag:"ä¹¾çˆ½ãƒ»ä¿è½ãƒ»å•¤é…’èŠ±é¦™", moods:["ç–²æ†Š","æƒ³æ”¾ä¸‹","æƒ³èŠå¤©"],
        story:"åƒæŠŠã€ä»Šå¤©ã€åˆ‡æˆä¿è½çš„ä¸€åˆ€ï¼šæ¸…ã€è„†ã€ä¹¾çˆ½ï¼Œæ€ç·’æœƒæ›´ä¹¾æ·¨ã€‚",
        flavor:"å•¤é…’èŠ±é¦™æ›´æ˜é¡¯ã€è‹¦éŸ»ä¿è½ã€æ¸…çˆ½ã€‚",
        trait:"æ¸…é†’æ„Ÿé«˜ã€é©åˆæ•´ç†å¿ƒæƒ…ã€‚",
        warn:"é…¸è‹¦æ„Ÿå¯èƒ½åˆºæ¿€èƒƒï¼Œè«‹æ­é…é£Ÿç‰©ã€‚",
        followUps:["ä½ è…¦è¢‹è£¡æœ€åµçš„é‚£å¥è©±æ˜¯ä»€éº¼ï¼Ÿ","ä½ æƒ³æŠŠå“ªæ®µæ€ç·’å…ˆæ”¾ä¸‹ï¼Ÿ","ä½ éœ€è¦ç­”æ¡ˆï¼Œé‚„æ˜¯éœ€è¦ä¼‘æ¯ï¼Ÿ"]},
      {id:3, cat:"beer", emoji:"ğŸº", name:"è‰¾çˆ¾ï¼ˆAleï¼‰", tag:"éº¥é¦™æº«æš–ãƒ»è€èŠ", moods:["æƒ³èŠå¤©","ç–²æ†Š","æƒ³æ”¾ä¸‹"],
        story:"è‰¾çˆ¾åƒæœƒé™ªä½ èŠçš„æœ‹å‹ï¼šæº«æš–ã€æœ‰é¦™æ°£ï¼Œè®“å¿ƒäº‹è®Šå¥½èªªã€‚",
        flavor:"è¼ƒåšçš„éº¥èŠ½é¦™ã€å¯èƒ½å¸¶æœé¦™/ç„¦ç³–æ„Ÿã€‚",
        trait:"æº«æš–è€èŠã€æƒ…ç·’å®‰æ’«æ„Ÿå¼·ã€‚",
        warn:"é…’æ„Ÿæ¯”æ‹‰æ ¼æ˜é¡¯ï¼Œåˆ¥æ€¥è‘—å–å¿«ã€‚",
        followUps:["ä½ æƒ³æŠŠå¿ƒäº‹èªªçµ¦èª°è½ï¼Ÿ","ä½ å¸Œæœ›ä»Šæ™šçš„èŠå¤©åæº«æŸ”é‚„æ˜¯ç›´æ¥ï¼Ÿ","æœ€æƒ³è¢«ç†è§£çš„æ˜¯å“ªä¸€ä»¶äº‹ï¼Ÿ"]},
      {id:4, cat:"beer", emoji:"ğŸº", name:"IPA", tag:"è‹¦é¦™é†’è…¦ãƒ»åå·®å›ç”˜", moods:["æƒ³æ”¾ä¸‹","æƒ³èŠå¤©","é–‹å¿ƒ"],
        story:"å…ˆè‹¦å¾Œå›ç”˜åƒæˆé•·ï¼šæ‰¿èªç´¯ï¼Œæ‰æœƒå›ç”œã€‚",
        flavor:"å•¤é…’èŠ±çˆ†é¦™ã€æŸ‘æ©˜/æ¾é‡æ„Ÿã€è‹¦éŸ»æ˜é¡¯ã€‚",
        trait:"è½‰æ›æƒ…ç·’ã€é†’è…¦ã€å€‹æ€§é®®æ˜ã€‚",
        warn:"åˆå­¸è€…å°‘é‡ï¼›è‹¦å‘³å¯èƒ½è®“ä½ å–æ›´å¿«ï¼Œè¨˜å¾—æ…¢ã€‚",
        followUps:["ä½ è¦ºå¾—è‹¦çš„æ˜¯äº‹æƒ…ï¼Œé‚„æ˜¯æœŸå¾…ï¼Ÿ","ä½ æƒ³è¦å›ç”˜çš„é‚£ä¸€åˆ»é•·ä»€éº¼æ¨£ï¼Ÿ","ä½ é¡˜æ„ç‚ºè‡ªå·±å‹‡æ•¢ä¸€æ¬¡å—ï¼Ÿ"]},
      {id:5, cat:"beer", emoji:"ğŸº", name:"å°éº¥å•¤é…’ï¼ˆWheatï¼‰", tag:"æŸ”å’Œæœé¦™ãƒ»åƒé›²", moods:["ç–²æ†Š","é–‹å¿ƒ","æƒ³èŠå¤©"],
        story:"åƒä¸€åœ˜é›²æŠŠä½ åŒ…ä½ï¼šä¸åˆºã€ä¸ç¡¬ï¼Œç·Šç¹ƒæœƒé¬†ä¸€é»ã€‚",
        flavor:"æŸ”å’Œéº¥é¦™ã€å¯èƒ½æœ‰é¦™è•‰/ä¸é¦™èˆ¬çš„è¼•æœé¦™ï¼ˆä¾é¢¨æ ¼ï¼‰ã€‚",
        trait:"å£æ„Ÿåœ“æ½¤ã€å¾ˆæº«æŸ”ã€å¥½å…¥å£ã€‚",
        warn:"å°éº©è³ªæ•æ„Ÿè€…é¿å…ï¼›ç”œæ„Ÿä¹Ÿå®¹æ˜“å–å¤šã€‚",
        followUps:["ä½ æƒ³å°è‡ªå·±æº«æŸ”ä¸€é»çš„æ˜¯å“ªè£¡ï¼Ÿ","ä½ ä»Šå¤©æœ‰æ²’æœ‰æƒ³è¢«æŠ±æŠ±çš„ç¬é–“ï¼Ÿ","ä½ é¡˜æ„æ”¾éè‡ªå·±ä¸€æ¬¡å—ï¼Ÿ"]},
      {id:6, cat:"beer", emoji:"ğŸº", name:"é»‘å•¤ï¼ˆStoutï¼‰", tag:"å¯å¯çƒ˜ç„™ãƒ»å¤œæ™šæ“æŠ±", moods:["æƒ³æ”¾ä¸‹","ç–²æ†Š","æƒ³èŠå¤©"],
        story:"åšåšçš„é»‘å•¤åƒå¤œæ™šçš„æŠ±æŠ±ï¼šæ…¢æ…¢å–ï¼Œå¿ƒä¹Ÿæ…¢æ…¢å®‰ã€‚",
        flavor:"å¯å¯/å’–å•¡çƒ˜ç„™é¦™ã€ç„¦ç³–æ„Ÿã€åšå¯¦ã€‚",
        trait:"å®‰å®šã€é™ªä¼´æ„Ÿå¼·ã€é©åˆç¨è™•æ²‰æ¾±ã€‚",
        warn:"å£æ„Ÿæ¿ƒåˆ¥çŒ›çŒï¼›é…ç”œé»/é¹¹é£Ÿéƒ½å¾ˆæ£’ã€‚",
        followUps:["ä½ æƒ³è¢«åŒ…ä½çš„æ˜¯å“ªä¸€ç¨®å­¤å–®ï¼Ÿ","ä»Šæ™šä½ æœ€éœ€è¦å®‰æ…°é‚„æ˜¯è‚¯å®šï¼Ÿ","ä½ é¡˜æ„å…è¨±è‡ªå·±æ…¢ä¸‹ä¾†å—ï¼Ÿ"]},

      {id:7, cat:"red", emoji:"ğŸ·", name:"å¡æœ¬å…§è˜‡ç¶­æ¿ƒ", tag:"æˆç†Ÿæœ‰åŠ›ãƒ»çµæ§‹æ„Ÿç´…é…’", moods:["æƒ³æ”¾ä¸‹","æƒ³èŠå¤©","æƒ³æ…¶ç¥"],
        story:"åƒä¸€ä½æœ‰è‚©è†€çš„å¤§äººï¼šä½ å¯ä»¥é ä¸€ä¸‹ï¼Œç„¶å¾Œæƒ³èµ·ä½ å…¶å¯¦ä¹Ÿå¾ˆå¼·ã€‚",
        flavor:"é»‘é†‹æ —ã€æœ¨è³ªã€å–®å¯§æ„Ÿè¼ƒæ˜é¡¯ã€‚",
        trait:"å„€å¼æ„Ÿã€æ’ä½è‡ªå·±ã€é©åˆé…é¤æ…¢èŠã€‚",
        warn:"é…’æ„Ÿè¼ƒå¼·ï¼Œæ­é…é£Ÿç‰©æ›´èˆ’æœã€‚",
        followUps:["ä½ æœ€è¿‘æœ€æ’çš„æ˜¯å“ªä»¶äº‹ï¼Ÿ","ä½ é¡˜æ„æŠŠè²¬ä»»æ”¾ä¸‹ä¸€é»é»å—ï¼Ÿ","ä½ æƒ³æ›¿è‡ªå·±ç«‹å“ªå€‹ç•Œç·šï¼Ÿ"]},
      {id:8, cat:"red", emoji:"ğŸ·", name:"æ¢…æ´›ï¼ˆMerlotï¼‰", tag:"æŸ”é †åœ“æ½¤ãƒ»æº«æŸ”ç´…é…’", moods:["ç–²æ†Š","æƒ³èŠå¤©","æƒ³æ”¾ä¸‹"],
        story:"å®ƒä¸é€¼ä½ å‹‡æ•¢ï¼Œåªè¼•è¼•èªªï¼šä½ å·²ç¶“åšå¾—å¾ˆå¥½äº†ã€‚",
        flavor:"ç´…è“/æå­ã€æŸ”é †ã€å–®å¯§è¼ƒåœ“ã€‚",
        trait:"å®‰æ…°ç³»ã€æ˜“å…¥å£ã€é©åˆæ”¾é¬†è«‡å¿ƒã€‚",
        warn:"ç”œæŸ”å®¹æ˜“å–å¤šï¼›æ…¢æ…¢ä¾†ã€‚",
        followUps:["ä½ å¸Œæœ›æœ‰äººå°ä½ èªªã€ä½ å¾ˆå¥½ã€å—ï¼Ÿ","ä½ æœ€æƒ³è¢«ç¨±è®šçš„ä¸€ä»¶äº‹æ˜¯ï¼Ÿ","ä½ é¡˜æ„æŠŠæ¨™æº–æ”¾é¬†ä¸€é»å—ï¼Ÿ"]},

      {id:9, cat:"white", emoji:"ğŸ¥‚", name:"å¤å¤šå…§ï¼ˆChardonnayï¼‰", tag:"ç™½é…’ç¶“å…¸ãƒ»æŸ”å…‰è³ªåœ°", moods:["æƒ³æ…¶ç¥","é–‹å¿ƒ","æƒ³èŠå¤©"],
        story:"åƒæŠŠæ—¥å­èª¿æˆæŸ”å…‰ï¼šèˆ’æœä¸åˆºçœ¼ï¼Œè®“ä½ é¡˜æ„å°è‡ªå·±æ›´å¥½ã€‚",
        flavor:"è˜‹æœ/æŸ‘æ©˜ï¼›éƒ¨åˆ†é¢¨æ ¼å¸¶å¥¶æ²¹/çƒ¤éºµåŒ…æ„Ÿã€‚",
        trait:"å„ªé›…æ”¾é¬†ã€é©åˆçŠ’è³è‡ªå·±ã€‚",
        warn:"åˆ¥å†°éé ­ï¼›å¤ªå†°æœƒå£“æ‰é¦™æ°£ã€‚",
        followUps:["ä½ æƒ³æ€éº¼çŠ’è³è‡ªå·±ï¼Ÿ","ä½ ä»Šå¤©å€¼å¾—è¢«å¥½å¥½å°å¾…çš„ç†ç”±æ˜¯ï¼Ÿ","ä½ é¡˜æ„å°è‡ªå·±èªªã€æˆ‘å€¼å¾—ã€å—ï¼Ÿ"]},
      {id:10, cat:"white", emoji:"ğŸ¥‚", name:"ç™½è˜‡ç¶­æ¿ƒï¼ˆSauvignon Blancï¼‰", tag:"æ¸…æ–°è‰æœ¬ãƒ»åƒæ¸…æ™¨", moods:["æ¸…é†’ä¹Ÿå¥½","ç–²æ†Š","æƒ³æ”¾ä¸‹"],
        story:"åƒæ—©æ™¨é–‹çª—é‚£å£é¢¨ï¼šæ¸…çˆ½ã€æ˜äº®ï¼Œè®“ä½ æƒ³é‡æ–°é–‹å§‹ã€‚",
        flavor:"è‰æœ¬ã€æŸ‘æ©˜ã€é…¸åº¦æ˜äº®ã€‚",
        trait:"é‡å•Ÿæ„Ÿã€æ¸…é†’æ„Ÿé«˜ã€å¾ˆè§£è†©ã€‚",
        warn:"èƒƒé…¸æ•æ„Ÿè€…é…é£Ÿç‰©ï¼›æ…¢å–ã€‚",
        followUps:["ä½ æƒ³é‡æ–°é–‹å§‹çš„ç¬¬ä¸€æ­¥æ˜¯ï¼Ÿ","ä½ é¡˜æ„æŠŠä»Šå¤©ç•¶ç·´ç¿’å—ï¼Ÿ","ä½ æœ€æƒ³æ¸…çˆ½æ‰çš„æ˜¯ä»€éº¼ï¼Ÿ"]},

      {id:11, cat:"white", emoji:"ğŸ·", name:"ç²‰ç´…é…’ï¼ˆRosÃ©ï¼‰", tag:"è¼•ç›ˆå¯æ„›ãƒ»å‰›å‰›å¥½", moods:["é–‹å¿ƒ","æƒ³æ…¶ç¥","æƒ³èŠå¤©"],
        story:"åƒä¸€å¥å‰›å‰›å¥½çš„ç¨±è®šï¼šä¸éåº¦ã€ä¸æ•·è¡ï¼Œå¾ˆå‰›å¥½ã€‚",
        flavor:"è“æœã€èŠ±é¦™ã€è¼•ç›ˆå¾®ç”œï¼ˆä¾é¢¨æ ¼ï¼‰ã€‚",
        trait:"èŠå¤©å±€ç‹è€…ã€è¼•é¬†å¥½å¿ƒæƒ…ã€‚",
        warn:"ç”œå£æ›´å®¹æ˜“ä¸çŸ¥ä¸è¦ºå–å¤šã€‚",
        followUps:["ä½ æƒ³æŠŠä»Šæ™šè®Šå¯æ„›ä¸€é»å—ï¼Ÿ","ä½ æƒ³å°èª°èªªä¸€å¥å¥½è©±ï¼Ÿ","ä½ æœ€è¿‘çš„å°å¹¸ç¦æ˜¯ä»€éº¼ï¼Ÿ"]},
      {id:12, cat:"white", emoji:"ğŸ¥‚", name:"æ°£æ³¡é…’ï¼ˆSparklingï¼‰", tag:"æ³¡æ³¡å„€å¼æ„Ÿãƒ»æŠŠæ—¥å­è®Šäº®", moods:["æƒ³æ…¶ç¥","é–‹å¿ƒ","æƒ³èŠå¤©"],
        story:"æ¯å€‹æ³¡æ³¡éƒ½åœ¨èªªï¼šä½ å€¼å¾—é–‹å¿ƒã€‚å°å¿«æ¨‚ä¹Ÿå€¼å¾—ä¹¾æ¯ã€‚",
        flavor:"æ¸…è„†æ°£æ³¡ã€æœé¦™ã€æ”¶å£ä¿è½ã€‚",
        trait:"å„€å¼æ„Ÿã€æäº®æ°£æ°›ã€æœ€æœƒæ…¶ç¥ã€‚",
        warn:"æ°£æ³¡æœƒåŠ é€Ÿå¸æ”¶ï¼Œæ…¢æ…¢å–ã€‚",
        followUps:["ä½ æƒ³ç‚ºå“ªä»¶å°äº‹ä¹¾æ¯ï¼Ÿ","ä»Šå¤©æœ€äº®çš„ç¬é–“æ˜¯ï¼Ÿ","ä½ é¡˜æ„æŠŠå¿«æ¨‚ç•™ä¹…ä¸€é»å—ï¼Ÿ"]},

      {id:13, cat:"spirit", emoji:"ğŸ¥ƒ", name:"å¨å£«å¿Œï¼ˆWhiskyï¼‰", tag:"æ·±æ²‰æœ¨è³ªãƒ»æ…¢æ…¢èŠ", moods:["æƒ³èŠå¤©","æƒ³æ”¾ä¸‹","ç–²æ†Š"],
        story:"åƒæ·±å¤œå°è©±ï¼šä¸æ€¥è‘—çµè«–ï¼Œåªé™ªä½ æŠŠçœŸå¿ƒèªªå®Œã€‚",
        flavor:"æœ¨è³ªã€é¦™è‰ã€ç„¦ç³–ï¼ˆä¾æ¡¶é™³ï¼‰ã€‚",
        trait:"æ²‰æ¾±ã€å¾ˆæœ‰æ•…äº‹ã€é©åˆå°å£æ…¢å–ã€‚",
        warn:"é…’ç²¾æ¿ƒåº¦é«˜ï¼Œå°å£å³å¯ã€‚",
        followUps:["ä½ æœ€æƒ³èªªçš„çœŸå¿ƒæ˜¯å“ªå¥ï¼Ÿ","ä½ æƒ³è¦é™ªä¼´é‚„æ˜¯æ–¹å‘ï¼Ÿ","ä½ å¸Œæœ›è¢«æ€éº¼ç†è§£ï¼Ÿ"]},
      {id:14, cat:"spirit", emoji:"ğŸ¥ƒ", name:"æ³¢æœ¬ï¼ˆBourbonï¼‰", tag:"é¦™è‰ç„¦ç³–ãƒ»åƒå£çˆ", moods:["ç–²æ†Š","æƒ³æ”¾ä¸‹","æƒ³èŠå¤©"],
        story:"åƒå†¬å¤œçš„æ¯¯å­ï¼šç”œç”œçš„ï¼Œä½†ä¸è†©ï¼Œè®“ä½ æƒ³ç…§é¡§è‡ªå·±ã€‚",
        flavor:"é¦™è‰ã€ç„¦ç³–ã€çƒ¤æ©¡æœ¨ã€‚",
        trait:"æº«æš–å®‰å®šã€å¾ˆç™‚ç™’ã€‚",
        warn:"ç”œæ„Ÿæœƒè®“äººä½ä¼°é…’ç²¾ï¼Œå°å¿ƒã€‚",
        followUps:["ä½ ä»Šå¤©æœ€æƒ³è¢«ç…§é¡§çš„æ˜¯å¿ƒé‚„æ˜¯èº«é«”ï¼Ÿ","ä½ é¡˜æ„å°è‡ªå·±æº«æš–ä¸€ä¸‹å—ï¼Ÿ","ä½ æƒ³æŠŠå£“åŠ›æ”¾åˆ°å“ªè£¡ï¼Ÿ"]},
      {id:15, cat:"spirit", emoji:"ğŸ¥ƒ", name:"è˜‡æ ¼è˜­ï¼ˆScotchï¼‰", tag:"ç…™ç‡»æ³¥ç…¤ãƒ»å›æ†¶æ„Ÿ", moods:["æƒ³æ”¾ä¸‹","æƒ³èŠå¤©","æƒ³æ…¶ç¥"],
        story:"ç…™ç‡»åƒå›æ†¶ï¼šæœ‰äº›åˆºã€æœ‰äº›æš–ï¼Œå…¥å£å¾Œæ›´æ‡‚è‡ªå·±ã€‚",
        flavor:"ç…™ç‡»ã€æ³¥ç…¤ã€æµ·é¢¨é¹¹æ„Ÿï¼ˆä¾ç”¢å€ï¼‰ã€‚",
        trait:"å€‹æ€§å¼·ã€é©åˆæ…¢æ…¢å“ã€å¾ˆæœ‰æ•…äº‹ã€‚",
        warn:"åˆæ¬¡å¯åŠ ä¸€é»æ°´ï¼›ä¸è¦æ€¥å–ã€‚",
        followUps:["é‚£æ®µå›æ†¶ä½ æƒ³ç•™è‘—é‚„æ˜¯æ”¾ä¸‹ï¼Ÿ","ä½ é¡˜æ„åŸè«’ç•¶æ™‚çš„è‡ªå·±å—ï¼Ÿ","ä½ æƒ³è®“é‚£åœ˜ç…™æ•£å»å“ªï¼Ÿ"]},
      {id:16, cat:"spirit", emoji:"ğŸ¸", name:"ç´é…’ï¼ˆGinï¼‰", tag:"è‰æœ¬æ¸…é†’ãƒ»ä¿è½å¾®é†º", moods:["æ¸…é†’ä¹Ÿå¥½","æƒ³èŠå¤©","é–‹å¿ƒ"],
        story:"åƒæŠŠè…¦è¢‹æ•´ç†å¥½ï¼šæ¸…çˆ½ä¿è½ï¼Œä½†ä»æœ‰é¦™æ°£çš„æƒ…ç·’ã€‚",
        flavor:"æœæ¾å­ã€è‰æœ¬ã€æŸ‘æ©˜çš®é¦™ã€‚",
        trait:"æ¸…çˆ½ã€é©åˆèŠå¤©ã€å¾ˆæœ‰å±¤æ¬¡ã€‚",
        warn:"æ­é…å«ç³–é£²å¾ˆå®¹æ˜“å–å¿«ï¼Œè¨˜å¾—æ…¢ã€‚",
        followUps:["ä½ æƒ³æ¸…é†’åœ°å®ˆä½ä»€éº¼ï¼Ÿ","ä½ æƒ³æŠŠæ··äº‚æ•´ç†æˆå“ªä¸‰å€‹å­—ï¼Ÿ","ä½ é¡˜æ„å…ˆæŠŠè‡ªå·±æ”¾å›ä¸­å¿ƒå—ï¼Ÿ"]},
      {id:17, cat:"spirit", emoji:"ğŸ¸", name:"ä¼ç‰¹åŠ ï¼ˆVodkaï¼‰", tag:"ä¹¾æ·¨ä¸­æ€§ãƒ»å¾ˆå¥½é…", moods:["æƒ³æ…¶ç¥","æƒ³èŠå¤©","æ¸…é†’ä¹Ÿå¥½"],
        story:"åƒç™½ç´™ï¼šä½ æ€éº¼æ­ï¼Œå®ƒå°±æ€éº¼é™ªä½ ã€‚ä½ å¯ä»¥æ±ºå®šä»Šæ™šå‘³é“ã€‚",
        flavor:"ä¹¾æ·¨ã€é…’æ„Ÿç›´æ¥ã€é¦™æ°£å°‘ã€‚",
        trait:"ç™¾æ­åŸºåº•ã€é©åˆåšèª¿é…’ã€‚",
        warn:"é †å£ä¸ä»£è¡¨å¼±ï¼Œè«‹æ…¢æ…¢å–ã€‚",
        followUps:["ä½ æƒ³æŠŠä»Šæ™šèª¿æˆä»€éº¼å‘³é“ï¼Ÿ","ä½ æœ€æƒ³è‡ªå·±æ±ºå®šçš„æ˜¯ä»€éº¼ï¼Ÿ","ä½ é¡˜æ„ç‚ºè‡ªå·±é¸ä¸€æ¬¡å—ï¼Ÿ"]},
      {id:18, cat:"spirit", emoji:"ğŸ¥ƒ", name:"é¾èˆŒè˜­ï¼ˆTequilaï¼‰", tag:"é™½å…‰å†’éšªãƒ»ç›´çƒç†±çƒˆ", moods:["æƒ³æ…¶ç¥","é–‹å¿ƒ","æƒ³æ”¾ä¸‹"],
        story:"åƒæ²™æ¼ å¤ªé™½ï¼šç›´æ¥ã€ç†±çƒˆã€‚å–çš„ä¸æ˜¯åˆºæ¿€ï¼Œæ˜¯å‹‡æ•¢ã€‚",
        flavor:"æ¤ç‰©é¦™ã€èƒ¡æ¤’æ„Ÿã€ä¹¾çˆ½æ”¶å£ã€‚",
        trait:"ç†±æƒ…ã€è½‰é »é“ã€å¾ˆæœ‰åŠ›é‡ã€‚",
        warn:"åˆ¥é€£çºŒ shotï¼›æ…¢å–æœ€å®‰å…¨ã€‚",
        followUps:["ä½ æƒ³å†’éšªçš„æ˜¯å“ªå€‹å°æ­¥ï¼Ÿ","ä½ é¡˜æ„å‹‡æ•¢ä¸€æ¬¡æœƒé¸å“ªä»¶äº‹ï¼Ÿ","ä½ æƒ³æŠŠç†±æƒ…æ”¾å›å“ªè£¡ï¼Ÿ"]},

      {id:19, cat:"cocktail", emoji:"ğŸ¸", name:"è«å¸Œæ‰˜ï¼ˆMojitoï¼‰", tag:"è–„è·æ¸…çˆ½ãƒ»é€æ°£è‡ªç”±", moods:["é–‹å¿ƒ","ç–²æ†Š","æƒ³æ”¾ä¸‹"],
        story:"åƒæŠŠå¿ƒè£¡çš„æ‚¶æ‰“é–‹ä¸€æ¢ç¸«ï¼šè®“ä½ å‘¼å¸åˆ°è‡ªç”±ã€‚",
        flavor:"è–„è·ã€èŠå§†æ¸…é…¸ã€æ°£æ³¡æ¸…çˆ½ã€‚",
        trait:"å¾ˆè§£æ‚¶ã€å¾ˆå¤å¤©ã€æœ€æœƒè®“äººæ”¾é¬†ã€‚",
        warn:"æ¸…çˆ½å¾ˆå®¹æ˜“å–å¤šï¼Œæ…¢æ…¢å–ã€‚",
        followUps:["ä½ æƒ³åæ‰çš„é‚£å£æ‚¶æ°£æ˜¯ä»€éº¼ï¼Ÿ","ä½ æƒ³è‡ªç”±çš„æ˜¯å·¥ä½œé‚„æ˜¯é—œä¿‚ï¼Ÿ","ä½ é¡˜æ„å…ˆè®“è‡ªå·±å–˜å£æ°£å—ï¼Ÿ"]},
      {id:20, cat:"cocktail", emoji:"ğŸ¸", name:"ç‘ªæ ¼éº—ç‰¹ï¼ˆMargaritaï¼‰", tag:"é…¸ç”œé¹½é‚Šãƒ»æœ‰æ…‹åº¦", moods:["æƒ³æ”¾ä¸‹","æƒ³æ…¶ç¥","é–‹å¿ƒ"],
        story:"é¹½é‚Šåƒç•Œç·šï¼šä½ å¯ä»¥æº«æŸ”ï¼Œä½†ä¸å¿…å§”å±ˆè‡ªå·±ã€‚",
        flavor:"èŠå§†é…¸ã€é¾èˆŒè˜­ã€é¹½é‚Šæå‘³ã€‚",
        trait:"ä¿è½ã€å¾ˆæœ‰åº•æ°£ã€é©åˆå°è‡ªå·±èª å¯¦ã€‚",
        warn:"é…¸åº¦é«˜ï¼›èƒƒæ•æ„Ÿè€…æ­é£Ÿç‰©ã€‚",
        followUps:["ä½ æœ€æƒ³å°å“ªä»¶äº‹èªªã€ä¸ã€ï¼Ÿ","ä½ æƒ³å®ˆè­·çš„ç•Œç·šæ˜¯ä»€éº¼ï¼Ÿ","ä½ é¡˜æ„æŠŠè‡ªå·±æ”¾ç¬¬ä¸€ä½ä¸€æ¬¡å—ï¼Ÿ"]},
      {id:21, cat:"cocktail", emoji:"ğŸ¥ƒ", name:"è€å¤å…¸ï¼ˆOld Fashionedï¼‰", tag:"ç¶“å…¸ç©©é‡ãƒ»æ…¢ç”œ", moods:["æƒ³èŠå¤©","æƒ³æ”¾ä¸‹","ç–²æ†Š"],
        story:"ä¸è¿½æµè¡Œï¼ŒåªæŠŠåŸºæœ¬åšå¥½ã€‚åƒä½ ï¼šå…¶å¯¦å¾ˆå¯é ã€‚",
        flavor:"å¨å£«å¿Œã€ç³–ã€è‹¦ç²¾ã€æ©™çš®é¦™ã€‚",
        trait:"æ²‰ç©©è€èŠã€å¾ˆæˆç†Ÿçš„ç”œã€‚",
        warn:"æ¿ƒåº¦é«˜ï¼Œå°å£å°±å¾ˆå¤ ã€‚",
        followUps:["ä½ æœ€å¯é çš„ä¸€é¢æ˜¯ä»€éº¼ï¼Ÿ","ä½ é¡˜æ„æ‰¿èªä½ ä¹Ÿéœ€è¦è¢«ç…§é¡§å—ï¼Ÿ","ä½ æƒ³æŠŠç”Ÿæ´»è®Šç°¡å–®ä¸€é»å—ï¼Ÿ"]},
      {id:22, cat:"cocktail", emoji:"ğŸ¸", name:"å°¼æ ¼ç¾…å°¼ï¼ˆNegroniï¼‰", tag:"è‹¦ç”œå¹³è¡¡ãƒ»æˆç†Ÿåå·®", moods:["æƒ³æ”¾ä¸‹","æƒ³èŠå¤©","æƒ³æ…¶ç¥"],
        story:"å…ˆè‹¦å¾Œå›ç”˜ï¼šä¸æ˜¯æ¯æ¬¡éƒ½èˆ’æœï¼Œä½†æœƒæ›´æ‡‚è‡ªå·±ã€‚",
        flavor:"è‹¦ç”œè‰æœ¬ã€æŸ‘æ©˜çš®é¦™ã€å°¾éŸ»é•·ã€‚",
        trait:"æˆç†Ÿç³»ã€å¾ˆæœ‰å±¤æ¬¡ã€é©åˆæ…¢å“ã€‚",
        warn:"è‹¦æ„Ÿæ˜é¡¯ï¼Œåˆå­¸è€…å°‘é‡ã€‚",
        followUps:["ä½ æœ€è¿‘åœ¨ç·´ç¿’çš„æˆç†Ÿæ˜¯ä»€éº¼ï¼Ÿ","ä½ é¡˜æ„æŠŠã€è‹¦ã€èªªå‡ºå£å—ï¼Ÿ","å›ç”˜é‚£åˆ»ä½ æƒ³å°è‡ªå·±èªªä»€éº¼ï¼Ÿ"]},
      {id:23, cat:"cocktail", emoji:"ğŸ¸", name:"é¦¬ä¸å°¼ï¼ˆMartiniï¼‰", tag:"æ¥µç°¡ä¹¾æ·¨ãƒ»é«˜å†·å„ªé›…", moods:["æ¸…é†’ä¹Ÿå¥½","æƒ³æ”¾ä¸‹","æƒ³èŠå¤©"],
        story:"åƒä¸€å¥çŸ­å¥ï¼šä¸å¤šï¼Œä½†å¾ˆæº–ã€‚ä»Šæ™šä¸è§£é‡‹ä¹Ÿå¯ä»¥ã€‚",
        flavor:"ç´é…’/ä¼ç‰¹åŠ åŸºåº•ã€ä¹¾æ·¨è‰æœ¬ã€å¯èƒ½å¸¶æ©„æ¬–é¹¹é¦™ã€‚",
        trait:"ä¿è½ã€ç•Œç·šæ„Ÿã€å¾ˆå„ªé›…ã€‚",
        warn:"æ¿ƒåº¦é«˜ï¼Œæ…¢æ…¢å–ã€‚",
        followUps:["ä½ ä»Šå¤©æœ€æƒ³åœæ­¢è§£é‡‹çš„æ˜¯ä»€éº¼ï¼Ÿ","ä½ æƒ³è®“å“ªæ®µé—œä¿‚æ›´ä¹¾æ·¨ï¼Ÿ","ä½ é¡˜æ„å›åˆ°è‡ªå·±çš„ä¸­å¿ƒå—ï¼Ÿ"]},
      {id:24, cat:"cocktail", emoji:"ğŸ¸", name:"ç´é€šå¯§ï¼ˆGin Tonicï¼‰", tag:"æ¸…çˆ½è‰æœ¬ãƒ»ç°¡å–®è€å–", moods:["æ¸…é†’ä¹Ÿå¥½","é–‹å¿ƒ","æƒ³èŠå¤©"],
        story:"åƒæŠŠä»Šå¤©æ¸…æ‰ï¼šä½ ä¸å¿…è´ï¼Œåªè¦æŠŠè‡ªå·±ç…§é¡§å¥½ã€‚",
        flavor:"æœæ¾è‰æœ¬ï¼‹é€šå¯§å¾®è‹¦ï¼‹æ°£æ³¡ã€‚",
        trait:"æ¸…çˆ½ã€è€å–ã€èŠå¤©å¥½æœ‹å‹ã€‚",
        warn:"æ°£æ³¡åŠ é€Ÿå¸æ”¶ï¼›æ…¢å–ã€‚",
        followUps:["ä½ æƒ³æŠŠä»Šå¤©æ¸…æ‰çš„ç¬¬ä¸€ä»¶äº‹æ˜¯ï¼Ÿ","ä½ éœ€è¦æ”¾é¬†é‚„æ˜¯è‚¯å®šï¼Ÿ","ä½ é¡˜æ„æŠŠç…§é¡§è‡ªå·±ç•¶ç›®æ¨™å—ï¼Ÿ"]},
      {id:25, cat:"cocktail", emoji:"ğŸ…", name:"è¡€è…¥ç‘ªéº—ï¼ˆBloody Maryï¼‰", tag:"é¦™æ–™ç•ªèŒ„ãƒ»é†’è…¦æ¹¯æ„Ÿ", moods:["æ¸…é†’ä¹Ÿå¥½","æƒ³èŠå¤©","ç–²æ†Š"],
        story:"åƒä¸€ç¢—å‹‡æ•¢çš„æ¹¯ï¼šæœ‰é»è¾£ã€æœ‰é»é¹¹ï¼Œå–å®Œæœƒè¦ºå¾—æˆ‘é‚„å¯ä»¥ã€‚",
        flavor:"ç•ªèŒ„ã€é¦™æ–™ã€èƒ¡æ¤’/èŠ¹èœæ„Ÿï¼ˆä¾é…æ–¹ï¼‰ã€‚",
        trait:"æç¥ã€å¾ˆæœ‰å€‹æ€§ã€é©åˆæ—©åˆé¤ã€‚",
        warn:"å«é¹½é¦™æ–™ï¼›è¡€å£“/è…è‡Ÿéœ€ç•™æ„è€…æ…é£²ã€‚",
        followUps:["ä½ æƒ³å«é†’çš„æ˜¯å“ªå€‹å¿µé ­ï¼Ÿ","ä½ é¡˜æ„ç‚ºè‡ªå·±æ‰“æ°£ä¸€å¥å—ï¼Ÿ","ä½ çš„ã€é‚„å¯ä»¥ã€ä¾†è‡ªå“ªè£¡ï¼Ÿ"]},
      {id:26, cat:"cocktail", emoji:"ğŸ¥ƒ", name:"å¨å£«å¿Œé…¸ï¼ˆWhiskey Sourï¼‰", tag:"é…¸ç”œå¹³è¡¡ãƒ»æŸ”å’Œè½‰æŠ˜", moods:["æƒ³æ”¾ä¸‹","æƒ³èŠå¤©","ç–²æ†Š"],
        story:"åƒä¸€å¥é“æ­‰ï¼šä¸å‘å¾®ã€ä¸é€å¼·ï¼Œåªæ˜¯æŠŠé—œä¿‚æ‹‰å›å‰›å‰›å¥½ã€‚",
        flavor:"æª¸æª¬é…¸ã€å¨å£«å¿Œã€ç”œåº¦å¹³è¡¡ï¼Œå¯èƒ½å¸¶è›‹ç™½æ³¡æ²«ã€‚",
        trait:"æŸ”å’Œã€ä¿®è£œæ„Ÿã€å¾ˆé †å£ã€‚",
        warn:"é…¸åº¦ï¼‹é…’ç²¾éƒ½åœ¨ï¼Œæ…¢æ…¢å–ã€‚",
        followUps:["ä½ æƒ³ä¿®è£œçš„æ˜¯é—œä¿‚ï¼Œé‚„æ˜¯ä½ è‡ªå·±ï¼Ÿ","ä½ æœ€æƒ³å°èª°èªªä¸€å¥çœŸè©±ï¼Ÿ","ä½ é¡˜æ„çµ¦è‡ªå·±ä¸€å€‹è½‰æŠ˜å—ï¼Ÿ"]},
      {id:27, cat:"cocktail", emoji:"ğŸ¹", name:"é•·å³¶å†°èŒ¶ï¼ˆLong Island Iced Teaï¼‰", tag:"çœ‹ä¼¼æº«æŸ”å…¶å¯¦å¾ˆçŒ›", moods:["æƒ³æ…¶ç¥","æƒ³èŠå¤©","é–‹å¿ƒ"],
        story:"åƒã€çœ‹èµ·ä¾†æ²’äº‹ã€çš„ä½ ï¼šè¡¨é¢è¼•é¬†ï¼Œè£¡é¢å…¶å¯¦æ’å¾ˆä¹…ã€‚",
        flavor:"å¤šåŸºé…’æ··åˆã€æŸ‘æ©˜èˆ‡å¯æ¨‚æ„Ÿã€é…’æ„Ÿéš±è—ã€‚",
        trait:"æ´¾å°æ„Ÿå¼·ã€ä½†è¦å¾ˆå…‹åˆ¶ã€‚",
        warn:"æ¿ƒåº¦é«˜ï¼å‹™å¿…æ…¢å–ï¼›å–é…’ä¸é–‹è»Šã€‚",
        followUps:["ä½ æœ‰å“ªä»¶äº‹å…¶å¯¦æ’å¾ˆä¹…ï¼Ÿ","ä½ é¡˜æ„è®“è‡ªå·±ä¸ç”¨å‡è£å—ï¼Ÿ","ä½ æƒ³æŠŠè² æ“”äº¤çµ¦èª°ä¸€é»é»ï¼Ÿ"]},

      {id:28, cat:"spirit", emoji:"ğŸ¶", name:"æ¸…é…’ï¼ˆæ—¥æœ¬é…’ï¼‰", tag:"ç±³é¦™æŸ”å’Œãƒ»å®‰éœé™ªä¼´", moods:["æƒ³èŠå¤©","æƒ³æ”¾ä¸‹","ç–²æ†Š"],
        story:"åƒéœéœé»ç‡ˆï¼šä¸åµï¼Œä½†è®“ä½ è¦ºå¾—æœ‰äººåœ¨ã€‚",
        flavor:"ç±³é¦™ã€æŸ”å’Œç”œæ—¨ã€å°¾éŸ»ä¹¾æ·¨ï¼ˆä¾é¢¨æ ¼ï¼‰ã€‚",
        trait:"å¾ˆå®‰éœã€å¾ˆæº«æŸ”ã€é©åˆæ²‰æ¾±ã€‚",
        warn:"åˆ¥çŒ›çŒï¼›æº«é£²/å†·é£²çš†å¯ã€‚",
        followUps:["ä½ æƒ³è¦å®‰éœï¼Œé‚„æ˜¯è¢«ç†è§£ï¼Ÿ","ä½ é¡˜æ„è®“è‡ªå·±è¢«é™ªä¸€ä¸‹å—ï¼Ÿ","ä»Šæ™šä½ æƒ³æŠŠå¿ƒæ”¾åœ¨å“ªï¼Ÿ"]},
      {id:29, cat:"cocktail", emoji:"ğŸ‘", name:"æ¢…é…’", tag:"é…¸ç”œæœé¦™ãƒ»å¯æ„›ä½†åˆ¥å°çœ‹", moods:["é–‹å¿ƒ","æƒ³èŠå¤©","æƒ³æ…¶ç¥"],
        story:"åƒä¸€å¥æ’’å¬Œï¼šç”œç”œå¸¶é…¸ï¼Œè®“å¿ƒè®Šå¾—å¥½æ‰“é–‹ã€‚",
        flavor:"æ¢…å­æœé¦™ã€é…¸ç”œå¹³è¡¡ã€æŸ”é †ã€‚",
        trait:"è¼•é¬†ã€è¦ªåˆ‡ã€å¾ˆé©åˆèŠå¤©ã€‚",
        warn:"ç”œå£å¾ˆå®¹æ˜“å–å¤šï¼›æ…¢æ…¢å–ã€‚",
        followUps:["ä½ é¡˜æ„å°è‡ªå·±æ’’å¬Œä¸€ä¸‹å—ï¼Ÿ","ä½ ä»Šå¤©æƒ³è¦çš„ç”œæ˜¯å“ªä¸€ç¨®ï¼Ÿ","ä½ æœ€è¿‘çš„å°ç¢ºå¹¸æ˜¯ä»€éº¼ï¼Ÿ"]},
      {id:30, cat:"spirit", emoji:"ğŸ¶", name:"ç´¹èˆˆé…’", tag:"é†‡åšç±³é¦™ãƒ»å®¶å¸¸æº«æš–", moods:["ç–²æ†Š","æƒ³æ”¾ä¸‹","æƒ³èŠå¤©"],
        story:"åƒé•·è¼©çš„é—œå¿ƒï¼šä¸èŠ±ä¿ï¼Œä½†å¾ˆçœŸã€‚æœ‰æ™‚è¢«ç…§é¡§å¾ˆå¹¸ç¦ã€‚",
        flavor:"ç±³éº´é¦™ã€é†‡åšã€æº«æš–å°¾éŸ»ã€‚",
        trait:"å®‰å®šã€å®¶å¸¸æ„Ÿã€å¾ˆé©åˆé…é¤ã€‚",
        warn:"é…’æ„Ÿåšï¼›æ­é…é£Ÿç‰©æ›´èˆ’æœã€‚",
        followUps:["ä½ æœ€è¿‘æœ‰è¢«å¥½å¥½ç…§é¡§å—ï¼Ÿ","ä½ é¡˜æ„ç…§é¡§è‡ªå·±ä¸€ä¸‹å—ï¼Ÿ","ä½ æœ€æƒ³å›åˆ°çš„ã€å®¶ã€æ˜¯ä»€éº¼æ„Ÿè¦ºï¼Ÿ"]},
      {id:31, cat:"spirit", emoji:"ğŸ¥ƒ", name:"é«˜ç²±é…’", tag:"ç›´çƒè¾›é¦™ãƒ»å­˜åœ¨æ„Ÿå¼·", moods:["æƒ³æ”¾ä¸‹","æƒ³æ…¶ç¥","æƒ³èŠå¤©"],
        story:"åƒä¸€å¥çœŸè©±ï¼šä¸æ‹å½æŠ¹è§’ã€‚ä½†çœŸè©±ä¹Ÿè¦æº«æŸ”åœ°èªªã€‚",
        flavor:"è¾›é¦™ã€ç©€ç‰©é¦™ã€é…’æ„Ÿç›´æ¥ã€‚",
        trait:"æœæ–·ã€æ–·æ¨é›¢æ„Ÿã€å¾ˆæœ‰åŠ›é‡ã€‚",
        warn:"æ¿ƒåº¦é«˜ï¼å°å£å³å¯ï¼Œé¿å…é€£çºŒæ¯ã€‚",
        followUps:["ä½ æœ€æƒ³èªªçš„çœŸè©±æ˜¯ä»€éº¼ï¼Ÿ","ä½ æƒ³æŠŠå“ªå€‹ç³¾çµæ–·é–‹ï¼Ÿ","ä½ é¡˜æ„æº«æŸ”ä½†å …å®šä¸€æ¬¡å—ï¼Ÿ"]},

      {id:32, cat:"na", emoji:"ğŸ«§", name:"ç„¡é…’ç²¾èª¿é…’ï¼ˆMocktailï¼‰", tag:"ä¸å–ä¹Ÿå¾ˆé…·ãƒ»äº«å—æ°›åœ", moods:["æ¸…é†’ä¹Ÿå¥½","ç–²æ†Š","æƒ³æ”¾ä¸‹","æƒ³èŠå¤©","é–‹å¿ƒ"],
        story:"ä½ ä¸éœ€è¦é…’ç²¾æ‰èƒ½æ”¾é¬†ã€‚ä½ å€¼å¾—çš„æ˜¯è¢«å¥½å¥½å°å¾…çš„å¤œæ™šã€‚",
        flavor:"ä¾é…æ–¹ï¼šæœé¦™/è‰æœ¬/æ°£æ³¡ï¼Œæ¸…çˆ½æ„Ÿé«˜ã€‚",
        trait:"å®‰å…¨ç¬¬ä¸€ã€æ°£æ°›æ»¿åˆ†ã€å¾ˆé©åˆé–‹è»Šå‰ã€‚",
        warn:"ä»å¯èƒ½å«ç³–è¼ƒé«˜ï¼›æ³¨æ„æ”å–ã€‚",
        followUps:["ä»Šæ™šä¸å–é…’ä¹Ÿæ²’é—œä¿‚ï¼Œä½ æƒ³æ€éº¼æº«æŸ”è‡ªå·±ï¼Ÿ","ä½ é¡˜æ„æŠŠå®‰å…¨æ”¾ç¬¬ä¸€å—ï¼Ÿ","å¦‚æœåªé¸ä¸€å€‹èˆ’æœçš„å°äº‹ï¼Œä½ é¸ä»€éº¼ï¼Ÿ"]},
      {id:33, cat:"na", emoji:"ğŸ¥‚", name:"ä½é…’ç²¾æ°£æ³¡èª¿é£²", tag:"å¾®ç”œå¾®é†ºãƒ»è¼•ç›ˆä¸è² æ“”", moods:["é–‹å¿ƒ","æƒ³æ…¶ç¥","ç–²æ†Š","æƒ³èŠå¤©"],
        story:"åƒæŠŠç–²æ†Šèª¿å¾—æ›´è¼•ï¼šä¸ç¡¬æ’ï¼Œä¹Ÿä¸æ”¾ç¸±ã€‚å‰›å‰›å¥½æœ€ç¾ã€‚",
        flavor:"è¼•æœé¦™ã€ç´°ç·»æ°£æ³¡ã€ç”œåº¦æŸ”å’Œã€‚",
        trait:"è¼•ç›ˆã€å¥½å…¥å£ã€ä¿ç•™æ¸…é†’æ„Ÿã€‚",
        warn:"ä»å«é…’ç²¾ï¼›æœªæ»¿ 18 ç¦æ­¢é£²ç”¨ã€‚",
        followUps:["ä½ æƒ³æŠŠä»Šå¤©è®Šè¼•çš„ç¬¬ä¸€æ­¥æ˜¯ä»€éº¼ï¼Ÿ","ä½ é¡˜æ„å…è¨±è‡ªå·±ã€å‰›å‰›å¥½ã€å°±å¥½å—ï¼Ÿ","ä½ æƒ³è¦çš„å¿«æ¨‚æ˜¯å®‰éœé‚„æ˜¯ç†±é¬§ï¼Ÿ"]}
    ];

    // ========= ç‹€æ…‹ =========
    let currentMood = null;
    let currentDrink = null;
    let currentHistoryTs = null; // âœ… é€™æ¬¡ç´€éŒ„ tsï¼Œç”¨æ–¼å¯« memo
    let bearLineFactory = null;  // âœ… é»æ°£æ³¡æ›å¥

    function findDrink(id){ return DRINKS.find(d=>d.id===id) || null; }
    function getPool(){
      if(!currentMood) return DRINKS;
      return DRINKS.filter(d => (d.moods||[]).includes(currentMood));
    }

    function setFavButton(){
      if(!currentDrink){ $("btnFav").textContent = "â­ æ”¶è—"; return; }
      $("btnFav").textContent = isFav(currentDrink.id) ? "âœ… å·²æ”¶è—" : "â­ æ”¶è—";
    }

    async function withLoading(fn){
      loading.classList.add("show");
      const minDelay = new Promise(res=>setTimeout(res, 900));
      const run = Promise.resolve().then(fn);
      await Promise.all([minDelay, run]);
      loading.classList.remove("show");
    }

    // ========= é…’å¡è·³çª— =========
    const drinkMask = $("drinkMask");
    function openDrinkModal(){ drinkMask.classList.add("show"); }
    function closeDrinkModal(){ drinkMask.classList.remove("show"); }
    $("drinkClose").addEventListener("click", closeDrinkModal);
    drinkMask.addEventListener("click", (e)=>{ if(e.target===drinkMask) closeDrinkModal(); });

    function buildBearLine(moodUsed){
      const moodLine = moodUsed ? pick(MOOD_BEAR[moodUsed] || ["ğŸ»ã€Œæˆ‘åœ¨ã€‚ã€"]) : "ğŸ»ã€Œæˆ‘åœ¨é€™è£¡ï¼Œæ…¢æ…¢ä¾†ã€‚ã€";
      const core = moodLine + "\nğŸ»ã€Œä½ é¡˜æ„æŠŠå¿ƒäº‹èªªä¸€é»é»çµ¦æˆ‘è½å—ï¼Ÿã€";
      return () => pick([core, ...BEAR_EXTRA_LINES]);
    }

    function renderDrinkModal(drink, moodUsed, modeLabel, historyTs){
      currentDrink = drink;
      currentHistoryTs = historyTs ?? null;

      $("drinkTitle").textContent = modeLabel || "ä»Šæ™šçš„ä¸€æ¯";
      $("drinkEmoji").textContent = drink.emoji;
      $("drinkName").textContent = drink.name;
      $("drinkTag").textContent = drink.tag;

      bearLineFactory = buildBearLine(moodUsed);
      $("bearBubble").textContent = bearLineFactory();

      $("drinkMoodLine").style.display = moodUsed ? "inline-block" : "none";
      if(moodUsed){
        $("drinkMoodLine").textContent = `ä¾å¿ƒæƒ…æ¨è–¦ï¼š${moodUsed}ï½œé©åˆï¼š${(drink.moods||[]).join("ã€")}`;
      }

      $("drinkFollow").textContent = "ğŸ»ã€Œ" + pick(drink.followUps || ["ä½ ä»Šå¤©é‚„å¥½å—ï¼Ÿ"]) + "ã€";
      $("drinkStory").textContent = drink.story;
      $("drinkFlavor").textContent = drink.flavor;
      $("drinkTrait").textContent = drink.trait;
      $("drinkWarn").textContent = drink.warn + "\n" + pick(GENERAL_WARN);

      // memo é å¡«
      const memoInput = $("memoInput");
      memoInput.value = "";
      if(historyTs){
        const h = getHistory();
        const row = h.find(x=>x.ts===historyTs);
        if(row && row.memo) memoInput.value = row.memo;
      }

      setFavButton();
      openDrinkModal();
    }

    // âœ… é»ç†Šç†Šæ°£æ³¡æ›ä¸€å¥
    $("bearBubble").addEventListener("click", ()=>{
      if(!bearLineFactory){
        $("bearBubble").textContent = pick(BEAR_EXTRA_LINES);
        return;
      }
      $("bearBubble").textContent = bearLineFactory();
      showToast("ç†Šç†Šæ›ä¸€å¥é™ªä½  ğŸ»");
    });

    // âœ… ä»Šæ™šæˆ‘æƒ³è¨˜ä½ï¼šä¿å­˜ memoï¼ˆå¯«å…¥ localStorageï¼Œé¡¯ç¤ºåœ¨æ­·å²ï¼‰
    $("btnSaveMemo").addEventListener("click", ()=>{
      const memo = ($("memoInput").value || "").trim();
      if(!memo){ showToast("å…ˆå¯«ä¸€å¥å†ä¿å­˜ ğŸ“"); return; }

      if(!currentHistoryTs){
        // æ²’æœ‰å°æ‡‰ç´€éŒ„å°±æ–°å¢ä¸€ç­†
        const ts = Date.now();
        currentHistoryTs = ts;
        addHistory({
          ts,
          mood: currentMood,
          drinkId: currentDrink ? currentDrink.id : null,
          via: "memoOnly",
          memo
        });
        showToast("å·²ä¿å­˜åˆ°ç´€éŒ„ ğŸ“");
        return;
      }

      const ok = updateHistoryMemo(currentHistoryTs, memo);
      showToast(ok ? "å·²ä¿å­˜åˆ°ç´€éŒ„ ğŸ“" : "ä¿å­˜å¤±æ•—ï¼ˆæ‰¾ä¸åˆ°ç´€éŒ„ï¼‰");
    });

    // æ”¶è— / è¤‡è£½
    $("btnFav").addEventListener("click", ()=>{
      if(!currentDrink){ showToast("å…ˆé¸ä¸€æ¯å†æ”¶è— ğŸ»"); return; }
      const on = toggleFav(currentDrink.id);
      setFavButton();
      showToast(on ? "å·²æ”¶è— â­" : "å·²å–æ¶ˆæ”¶è—");
      if(listMask.classList.contains("show")) renderList();
    });

    $("btnCopy").addEventListener("click", ()=>{
      const text = ($("bearBubble").textContent + "\n" + $("drinkFollow").textContent).trim();
      navigator.clipboard?.writeText(text);
      showToast("å·²è¤‡è£½ç†Šç†Šè©±èª ğŸ»ğŸ·");
    });

    // ========= æ¸…å–®/æ­·å²/æ”¶è—è·³çª— =========
    const listMask = $("listMask");
    const listContent = $("listContent");
    const searchRow = $("searchRow");
    const searchInput = $("searchInput");
    const filterRow = $("filterRow");
    const filterBtns = Array.from(document.querySelectorAll(".filter-btn"));

    let listTab = "catalog"; // catalog / history / fav
    let catFilter = "all";   // all/beer/red/white/spirit/cocktail/na

    function openListModal(tab){
      listTab = tab || "catalog";
      listMask.classList.add("show");
      setTabs();
      renderList();
      if(listTab==="catalog") searchInput.focus();
    }
    function closeListModal(){ listMask.classList.remove("show"); }
    $("listClose").addEventListener("click", closeListModal);
    listMask.addEventListener("click", (e)=>{ if(e.target===listMask) closeListModal(); });

    function setTabs(){
      $("tabCatalog").classList.toggle("active", listTab==="catalog");
      $("tabHistory").classList.toggle("active", listTab==="history");
      $("tabFav").classList.toggle("active", listTab==="fav");

      $("listTitle").textContent =
        listTab==="catalog" ? "ğŸ“š é…’æ¸…å–®" :
        listTab==="history" ? "ğŸ•°ï¸ æ­·å²ç´€éŒ„" : "â­ æ”¶è—æ¸…å–®";

      const showCatalog = (listTab==="catalog");
      searchRow.style.display = showCatalog ? "flex" : "none";
      filterRow.style.display = showCatalog ? "flex" : "none";
    }

    $("tabCatalog").addEventListener("click", ()=>{ listTab="catalog"; setTabs(); renderList(); });
    $("tabHistory").addEventListener("click", ()=>{ listTab="history"; setTabs(); renderList(); });
    $("tabFav").addEventListener("click", ()=>{ listTab="fav"; setTabs(); renderList(); });

    $("btnSearchClear").addEventListener("click", ()=>{ searchInput.value=""; renderList(); });
    searchInput.addEventListener("input", ()=>renderList());

    // âœ… åˆ†é¡ç¯©é¸
    filterBtns.forEach(b=>{
      b.addEventListener("click", ()=>{
        catFilter = b.dataset.cat;
        filterBtns.forEach(x=>x.classList.toggle("active", x.dataset.cat===catFilter));
        renderList();
      });
    });

    function renderList(){
      listContent.innerHTML = "";

      if(listTab==="catalog"){
        const q = (searchInput.value || "").trim();
        let pool = DRINKS.slice();

        if(catFilter !== "all"){
          pool = pool.filter(d => d.cat === catFilter);
        }
        if(q){
          pool = pool.filter(d => (d.name + " " + d.tag).includes(q));
        }

        if(pool.length===0){
          listContent.innerHTML = `<div class="smallnote">æ‰¾ä¸åˆ°ç¬¦åˆæ¢ä»¶çš„é…’ï½æ›å€‹åˆ†é¡æˆ–é—œéµå­—è©¦è©¦ ğŸ»</div>`;
          return;
        }

        pool.forEach(d=>{
          const div = document.createElement("div");
          div.className = "item";
          div.innerHTML = `
            <div class="item-top">
              <div class="item-emoji">${d.emoji}</div>
              <div style="flex:1">
                <h5>${d.name}</h5>
                <div class="meta">${d.tag}<br>é©åˆï¼š${(d.moods||[]).join("ã€")}</div>
              </div>
            </div>
            <div class="item-actions">
              <button class="btn small" data-action="open" data-id="${d.id}">æ‰“é–‹</button>
              <button class="btn small secondary" data-action="fav" data-id="${d.id}">
                ${isFav(d.id) ? "å–æ¶ˆæ”¶è—" : "æ”¶è—"}
              </button>
            </div>
          `;
          listContent.appendChild(div);
        });
        return;
      }

      if(listTab==="history"){
        const h = getHistory();
        if(h.length===0){
          listContent.innerHTML = `<div class="smallnote">é‚„æ²’æœ‰ç´€éŒ„ï½å…ˆå»é¸ä¸€æ¯ ğŸ»ğŸ·</div>`;
          return;
        }
        h.slice(0,120).forEach(row=>{
          const d = row.drinkId ? findDrink(row.drinkId) : null;
          const title = d ? `${d.emoji} ${d.name}` : "ğŸ“ å¿ƒæƒ…ç´€éŒ„";
          const subtitle = d ? d.tag : "ä½ å¯«ä¸‹çš„ä¸€å¥è©±";
          const memoLine = row.memo ? `ğŸ“ ${row.memo}` : "";
          const moodLine = `å¿ƒæƒ…ï¼š${row.mood ?? "æœªé¸æ“‡"}`;

          const div = document.createElement("div");
          div.className = "item";
          div.innerHTML = `
            <div class="item-top">
              <div class="item-emoji">${d ? d.emoji : "ğŸ“"}</div>
              <div style="flex:1">
                <h5>${title}</h5>
                <div class="meta">${formatTime(row.ts)}ï½œ${moodLine}<br>${subtitle}${memoLine ? "<br>"+memoLine : ""}</div>
              </div>
            </div>
            <div class="item-actions">
              ${d ? `<button class="btn small" data-action="openHistory" data-id="${d.id}" data-ts="${row.ts}" data-mood="${row.mood ?? ""}">æ‰“é–‹</button>` : ""}
              ${d ? `<button class="btn small secondary" data-action="fav" data-id="${d.id}">${isFav(d.id) ? "å–æ¶ˆæ”¶è—" : "æ”¶è—"}</button>` : ""}
              <button class="btn small secondary" data-action="editMemo" data-ts="${row.ts}">ç·¨è¼¯å¿ƒæƒ…</button>
            </div>
          `;
          listContent.appendChild(div);
        });
        return;
      }

      if(listTab==="fav"){
        const f = getFav();
        if(f.length===0){
          listContent.innerHTML = `<div class="smallnote">ä½ é‚„æ²’æœ‰æ”¶è—ï½çœ‹åˆ°å–œæ­¡çš„é…’å°±é» â­</div>`;
          return;
        }
        f.forEach(id=>{
          const d = findDrink(id);
          if(!d) return;
          const div = document.createElement("div");
          div.className = "item";
          div.innerHTML = `
            <div class="item-top">
              <div class="item-emoji">${d.emoji}</div>
              <div style="flex:1">
                <h5>${d.name}</h5>
                <div class="meta">${d.tag}<br>é©åˆï¼š${(d.moods||[]).join("ã€")}</div>
              </div>
            </div>
            <div class="item-actions">
              <button class="btn small" data-action="open" data-id="${d.id}">æ‰“é–‹</button>
              <button class="btn small secondary" data-action="fav" data-id="${d.id}">å–æ¶ˆæ”¶è—</button>
            </div>
          `;
          listContent.appendChild(div);
        });
      }
    }

    listContent.addEventListener("click", async (e)=>{
      const btn = e.target.closest("button");
      if(!btn) return;

      const action = btn.dataset.action;

      if(action==="fav"){
        const id = Number(btn.dataset.id);
        toggleFav(id);
        renderList();
        if(currentDrink && currentDrink.id===id) setFavButton();
        showToast(isFav(id) ? "å·²æ”¶è— â­" : "å·²å–æ¶ˆæ”¶è—");
        return;
      }

      if(action==="open"){
        const id = Number(btn.dataset.id);
        const d = findDrink(id);
        if(!d) return;
        await withLoading(()=>{
          const ts = Date.now();
          addHistory({ts, mood: currentMood, drinkId: d.id, via:"catalog"});
          renderDrinkModal(d, currentMood, "ğŸ“š é…’æ¸…å–®ãƒ»ä½ é¸çš„é…’", ts);
        });
        return;
      }

      if(action==="openHistory"){
        const id = Number(btn.dataset.id);
        const ts = Number(btn.dataset.ts);
        const mood = btn.dataset.mood || null;
        const d = findDrink(id);
        if(!d) return;
        await withLoading(()=>renderDrinkModal(d, mood || currentMood, "ğŸ•°ï¸ æ­·å²å›é¡§", ts));
        return;
      }

      if(action==="editMemo"){
        const ts = Number(btn.dataset.ts);
        const h = getHistory();
        const row = h.find(x=>x.ts===ts);
        const old = row?.memo || "";
        const memo = prompt("ä»Šæ™šæˆ‘æƒ³è¨˜ä½ï¼ˆæœ€å¤š 60 å­—ï¼‰", old);
        if(memo===null) return;
        const v = (memo || "").trim().slice(0,60);
        updateHistoryMemo(ts, v);
        renderList();
        showToast("å·²æ›´æ–°å¿ƒæƒ… ğŸ“");
        return;
      }
    });

    // æ¸…ç©º
    $("btnClearHistory").addEventListener("click", ()=>{ localStorage.removeItem(KEY_HISTORY); renderList(); showToast("å·²æ¸…ç©ºæ­·å²"); });
    $("btnClearFav").addEventListener("click", ()=>{ localStorage.removeItem(KEY_FAV); renderList(); if(currentDrink) setFavButton(); showToast("å·²æ¸…ç©ºæ”¶è—"); });

    // ========= ä¸»ç•«é¢æŒ‰éˆ• =========
    $("btnIG").addEventListener("click", ()=>window.open(IG_URL, "_blank"));

    $("btnRandom").addEventListener("click", async ()=>{
      await withLoading(()=>{
        const pool = getPool();
        const chosen = pool.length ? pick(pool) : pick(DRINKS);
        const ts = Date.now();
        addHistory({ts, mood: currentMood, drinkId: chosen.id, via:"random"});
        renderDrinkModal(chosen, currentMood, "ğŸ² éš¨æ©Ÿä¸€æ¯", ts);
        if(currentMood && pool.length===0) showToast("é€™å€‹å¿ƒæƒ…æ²’æœ‰å°æ‡‰é…’æ¬¾ï¼Œæ”¹ç”¨å…¨é…’çª–éš¨æ©Ÿ ğŸ»");
      });
    });

    $("btnPickList").addEventListener("click", ()=>openListModal("catalog"));
    $("btnHistory").addEventListener("click", ()=>openListModal("history"));
    $("btnFavList").addEventListener("click", ()=>openListModal("fav"));

    $("btnTalk").addEventListener("click", async ()=>{
      await withLoading(()=>{
        currentDrink = null;
        currentHistoryTs = null;

        $("drinkTitle").textContent = "ğŸ’¬ ç†Šç†Šé™ªä½ èªªå¿ƒäº‹";
        $("drinkEmoji").textContent = "ğŸ»";
        $("drinkName").textContent = "ä½ ä¸ç”¨è§£é‡‹";
        $("drinkTag").textContent = "æŠŠä»Šå¤©èªªä¸€é»é»ï¼Œä¹Ÿå¾ˆå¥½";

        bearLineFactory = () => pick([
          (currentMood ? pick(MOOD_BEAR[currentMood]||["ğŸ»ã€Œæˆ‘åœ¨ã€‚ã€"]) : "ğŸ»ã€Œæˆ‘åœ¨é€™è£¡ï¼Œæ…¢æ…¢ä¾†ã€‚ã€") + "\nğŸ»ã€Œä½ ä»Šå¤©æœ€æƒ³è¢«æ€éº¼å°å¾…ï¼Ÿã€",
          ...BEAR_EXTRA_LINES
        ]);
        $("bearBubble").textContent = bearLineFactory();

        $("drinkMoodLine").style.display = currentMood ? "inline-block" : "none";
        if(currentMood) $("drinkMoodLine").textContent = `ä½ é¸çš„å¿ƒæƒ…ï¼š${currentMood}`;

        $("drinkFollow").textContent = "ğŸ»ã€Œå¦‚æœåªèƒ½èªªä¸€å¥ï¼Œä½ æœ€æƒ³è¢«ç†è§£çš„æ˜¯ä»€éº¼ï¼Ÿã€";
        $("drinkStory").textContent = "ä½ å¯ä»¥èªªä¸€å°æ®µï¼Œä¹Ÿå¯ä»¥ä»€éº¼éƒ½ä¸èªªã€‚\næˆ‘éƒ½åœ¨ã€‚";
        $("drinkFlavor").textContent = "ï¼ˆä»Šæ™šå…ˆä¸è«‡é…’ä¹Ÿå¯ä»¥ï¼‰";
        $("drinkTrait").textContent = "é™ªä¼´ã€å‚¾è½ã€æ…¢æ…¢ä¾†ã€‚";
        $("drinkWarn").textContent = pick(GENERAL_WARN);

        $("memoInput").value = "";
        $("btnFav").textContent = "â­ æ”¶è—";
        openDrinkModal();
      });
    });

    $("btnWarn").addEventListener("click", async ()=>{
      await withLoading(()=>{
        currentDrink = null;
        currentHistoryTs = null;

        $("drinkTitle").textContent = "âš ï¸ å¾®é†ºæé†’";
        $("drinkEmoji").textContent = "âš ï¸";
        $("drinkName").textContent = "æº«æŸ”ä½†é‡è¦";
        $("drinkTag").textContent = "æˆ‘å¸Œæœ›ä½ é–‹å¿ƒï¼Œä¹Ÿå¸Œæœ›ä½ å®‰å…¨";

        bearLineFactory = () => pick([
          "ğŸ»ã€Œæˆ‘ä¸åå°ä½ æ”¾é¬†ï¼Œä½†æˆ‘æ›´åœ¨æ„ä½ å¹³å®‰ã€‚ã€\nğŸ»ã€Œä»Šæ™šæˆ‘å€‘ä»¥ã€å‰›å‰›å¥½ã€ç‚ºç›®æ¨™ã€‚ã€",
          ...BEAR_EXTRA_LINES
        ]);
        $("bearBubble").textContent = bearLineFactory();

        $("drinkMoodLine").style.display = "none";
        $("drinkFollow").textContent = "ğŸ»ã€Œä½ é¡˜æ„å…ˆç…§é¡§å¥½èº«é«”ï¼Œå…¶ä»–æ˜å¤©å†èªªå—ï¼Ÿã€";
        $("drinkStory").textContent = "å¾®é†ºä¸æ˜¯éº»ç—ºï¼Œä¹Ÿä¸æ˜¯é€å¼·ã€‚\næ˜¯å‰›å‰›å¥½åœ°å°è‡ªå·±æº«æŸ”ã€‚";
        $("drinkFlavor").textContent = "ï¼ˆæé†’é æ²’æœ‰é¢¨å‘³æè¿°ï¼‰";
        $("drinkTrait").textContent = "å®‰å…¨ç¬¬ä¸€ã€æ…¢æ…¢å–ã€æ…¢æ…¢å›å®¶ã€‚";
        $("drinkWarn").textContent = GENERAL_WARN.join("\n");

        $("memoInput").value = "";
        $("btnFav").textContent = "â­ æ”¶è—";
        openDrinkModal();
      });
    });

    // ========= å¿ƒæƒ… =========
    const moodButtons = Array.from(document.querySelectorAll(".mood-btn"));
    moodButtons.forEach(btn=>{
      btn.addEventListener("click", ()=>{
        const mood = btn.dataset.mood;
        if(currentMood===mood){
          currentMood=null;
          moodButtons.forEach(b=>b.classList.remove("active"));
          $("moodPill").textContent="æœªé¸æ“‡";
          showToast("å·²å–æ¶ˆå¿ƒæƒ…ç¯©é¸");
        }else{
          currentMood=mood;
          moodButtons.forEach(b=>b.classList.toggle("active", b.dataset.mood===mood));
          const pool=getPool();
          $("moodPill").textContent=`${mood}ï¼ˆå¯é¸ ${pool.length} æ¯ï¼‰`;
          showToast(`å·²é¸æ“‡ï¼š${mood}ï½œéš¨æ©Ÿ/æ¸…å–®éƒ½æœƒå¸¶å…¥ç†Šç†Šé™ªèŠ`);
        }
      });
    });

    // ========= åˆå§‹åŒ– =========
    setBearImages();
    $("todayLine").textContent = pick(TODAY_LINES);
    $("countBadge").textContent = `ğŸ‡ å¾®é†ºé…’çª–ï½œå·²æ”¶éŒ„ ${DRINKS.length} æ¯`;

    // ========= PWAï¼šå®‰è£ =========
    let deferredPrompt = null;
    const installBtn = $("btnInstall");
    window.addEventListener("beforeinstallprompt", (e)=>{
      e.preventDefault();
      deferredPrompt = e;
      installBtn.style.display = "flex";
    });
    installBtn.addEventListener("click", async ()=>{
      if(!deferredPrompt){
        showToast("iPhoneï¼šSafari åˆ†äº« â†’ åŠ åˆ°ä¸»ç•«é¢");
        return;
      }
      deferredPrompt.prompt();
      const choice = await deferredPrompt.userChoice;
      deferredPrompt = null;
      if(choice && choice.outcome==="accepted"){
        showToast("å·²é–‹å§‹å®‰è£åˆ°ä¸»ç•«é¢ ğŸ“²");
        installBtn.style.display = "none";
      }else{
        showToast("æ²’é—œä¿‚ï½æƒ³è£å†ä¾†æ‰¾æˆ‘ ğŸ»");
      }
    });

    // ========= Service Worker =========
    if("serviceWorker" in navigator){
      window.addEventListener("load", ()=>navigator.serviceWorker.register("sw.js").catch(()=>{}));
    }
  </script>
</body>
</html>